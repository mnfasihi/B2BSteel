<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B2BSteel | پلتفرم تخصصی صنعت فولاد</title>

    <!-- فونت و آیکون -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ========== متغیرهای رنگ ========== */
        :root {
            --primary: #004586;
            --primary-dark: #002f5c;
            --accent: #E6B800;
            --bg: #F7F7F7;
            --card-bg: #FFFFFF;
            --muted: #6b7280;
            --dark: #1E1E1E;
            --text-dark: #2A2A2A;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
        }

        * {
            font-family: 'Vazirmatn', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--bg);
            color: var(--dark);
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            cursor: pointer;
            border: none;
            background: none;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .hidden {
            display: none !important;
        }

        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.8s ease forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========== ناوبری ========== */
        .navbar {
            background: var(--card-bg);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 0.8rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: all 0.3s;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            background: var(--primary);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 700;
            line-height: 1.2;
        }

        .logo-text .slogan {
            font-size: 0.85rem;
            color: var(--accent);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-link {
            color: #4b5563;
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.95rem;
            white-space: nowrap;
        }

        .nav-link:hover {
            background: #f3f4f6;
            color: var(--primary);
        }

        /* ========== دکمه‌ها ========== */
        .btn {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
            font-size: 0.95rem;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--muted);
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.85rem;
        }

        /* ========== صفحه اصلی - هیرو ========== */
        .hero {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 4rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 20%, rgba(230,184,0,0.15), transparent 70%),
                        radial-gradient(circle at 80% 80%, rgba(0,69,134,0.2), transparent 70%);
            z-index: 0;
        }

        .hero .container {
            position: relative;
            z-index: 1;
        }

        .hero h2 {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            opacity: 0.95;
        }

        .hero-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ========== شمارنده‌ها ========== */
        .counters {
            background: white;
            padding: 3rem 0;
            margin: 2rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .counters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .counter-item {
            text-align: center;
            padding: 1.5rem;
        }

        .counter-number {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .counter-label {
            font-size: 1.2rem;
            color: #4b5563;
        }

        /* ========== اسلایدشو ========== */
        .image-slider {
            width: 100%;
            height: 450px;
            position: relative;
            overflow: hidden;
            margin: 2rem 0;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .slider-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .slider-image.active {
            opacity: 1;
        }

        /* ========== کارت‌های ویژگی‌ها ========== */
        .features {
            padding: 4rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            color: var(--primary);
            font-size: 2rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: var(--card-bg);
            border-radius: 14px;
            padding: 2rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.06);
            transition: all 0.35s;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.1);
        }

        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.7rem;
            margin-bottom: 1rem;
        }

        .feature-card h3 {
            margin-bottom: 1rem;
            color: var(--primary);
        }

        /* ========== فرم‌های احراز هویت ========== */
        .auth-container {
            max-width: 500px;
            margin: 2rem auto;
            padding: 2rem;
        }

        .auth-card {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .auth-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #4b5563;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-help {
            font-size: 0.85rem;
            color: var(--muted);
            margin-top: 0.25rem;
        }

        .user-type-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .user-type-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            background: white;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-type-btn.active {
            border-color: var(--primary);
            background: #eff6ff;
            color: var(--primary);
        }

        /* ========== مودال ========== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: var(--primary);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--muted);
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* ========== داشبورد ========== */
        .dashboard {
            padding: 2rem 0;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: var(--muted);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        /* ========== فوتر ========== */
        .footer {
            background: var(--primary-dark);
            color: #ddd;
            padding: 4rem 0;
            margin-top: 4rem;
        }

        .footer h3 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .footer a {
            color: #ccc;
            transition: color 0.2s;
        }

        .footer a:hover {
            color: var(--accent);
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid #374151;
            color: #9ca3af;
        }

        /* ========== ریسپانسیو ========== */
        @media (max-width: 992px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            .nav-links {
                justify-content: center;
            }
        }
        @media (max-width: 768px) {
            .hero h2 {
                font-size: 1.8rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            .image-slider {
                height: 300px;
            }
            .counter-number {
                font-size: 2rem;
            }
            .date-selector {
                flex-direction: column;
            }
            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
<nav class="navbar">
    <div class="container nav-container">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-cubes"></i>
            </div>
            <div class="logo-text">
                <h1>B2BSteel</h1>
                <div class="slogan">اعتماد - شفافیت - سرعت</div>
            </div>
        </div>
        <div class="nav-links">
            <a href="#" class="nav-link" onclick="window.showPage('home')">خانه</a>
            <a href="#" class="nav-link" onclick="window.showPage('concrete-formwork')">قالب بتن</a>
            <a href="#" class="nav-link" onclick="window.showPage('shed')">سوله</a>
            <a href="#" class="nav-link" onclick="window.showPage('blog')">بلاگ</a>
            <a href="#" class="nav-link" onclick="window.showPage('terms')">قوانین</a>
            <a href="#" class="nav-link" onclick="window.showPage('guide')">راهنما</a>
            <div id="auth-buttons">
                <button class="btn btn-primary btn-sm" onclick="window.showPage('login')">ورود</button>
                <button class="btn btn-secondary btn-sm" onclick="window.showPage('register')">ثبت‌نام</button>
            </div>
            <div id="user-menu" class="hidden">
                <button class="btn btn-primary btn-sm" onclick="window.showPage('dashboard')">داشبورد</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
            <div id="seller-formwork-menu" class="hidden">
                <button class="btn btn-primary btn-sm" onclick="window.showPage('seller-formwork-dashboard')">داشبورد فروشنده قالب</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
            <div id="seller-shed-menu" class="hidden">
                <button class="btn btn-success btn-sm" onclick="window.showPage('seller-shed-dashboard')">داشبورد فروشنده سوله</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
            <div id="admin-menu" class="hidden">
                <button class="btn btn-warning btn-sm" onclick="window.showPage('admin')">پنل ادمین</button>
                <button class="btn btn-primary btn-sm" onclick="window.showPage('dashboard')">داشبورد</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
        </div>
    </div>
</nav>

<main id="pages">
    <section id="home-page" class="page">
        <div class="hero fade-in">
            <div class="container">
                <h2>پلتفرم B2BSteel</h2>
                <p>اولین پلتفرم تخصصی ارتباط خریداران و فروشندگان سوله و قالب فلزی بتن</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" style="padding: 12px 25px;" onclick="window.showPage('register')"><i class="fas fa-user-tie"></i> ثبت‌نام خریدار</button>
                    <button class="btn btn-success" style="padding: 12px 25px;" onclick="window.showPage('register')"><i class="fas fa-industry"></i> ثبت‌نام فروشنده</button>
                </div>
            </div>
        </div>
        <div class="counters">
            <div class="container">
                <div class="counters-grid">
                    <div class="counter-item"><div class="counter-number" id="counter-sellers">۰</div><div class="counter-label">فروشنده</div></div>
                    <div class="counter-item"><div class="counter-number" id="counter-buyers">۰</div><div class="counter-label">خریدار</div></div>
                    <div class="counter-item"><div class="counter-number" id="counter-transactions">۰</div><div class="counter-label">معامله موفق</div></div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="image-slider">
                <img src="https://img.edilportale.com/product-thumbs/b_P300-Pilosio-611087-rel51b5c439.jpg" class="slider-image active">
                <img src="https://img.edilportale.com/product-thumbs/b_P300-Pilosio-611087-rel991e93b7.jpg" class="slider-image">
                <div class="slider-image" style="background: linear-gradient(135deg, var(--primary-dark), var(--primary)); color: white; display: flex; align-items: center; justify-content: center;">صنعت ساختمان</div>
            </div>
        </div>
    </section>

    <section id="concrete-formwork-page" class="page hidden"><div class="hero"><div class="container"><h2>قالب فلزی بتن</h2><p>خرید و فروش تخصصی قالب فلزی</p></div></div></section>
    <section id="shed-page" class="page hidden"><div class="hero"><div class="container"><h2>سوله</h2><p>خرید و فروش تخصصی سوله</p></div></div></section>
    <section id="blog-page" class="page hidden"><div class="hero"><div class="container"><h2>بلاگ</h2></div></div></section>
    <section id="guide-page" class="page hidden"><div class="hero"><div class="container"><h2>راهنما</h2></div></div></section>

    <section id="terms-page" class="page hidden">
        <div class="container" style="max-width:800px;margin:2rem auto;padding:2rem;background:white;border-radius:10px;">
            <h2 class="section-title">قوانین و شرایط</h2>
            <p><strong>ماده ۱:</strong> پلتفرم B2BSteel صرفاً نقش اطلاع‌رسانی دارد و مسئولیتی در قبال معاملات ندارد.</p>
            <p><strong>ماده ۲:</strong> کاربران متعهد به ارائه اطلاعات صحیح هستند.</p>
            <p><strong>ماده ۳:</strong> امتیازدهی پس از معامله به شفافیت کمک می‌کند.</p>
            <p><strong>ماده ۴:</strong> حل اختلال از طریق مراجع قضایی صالح.</p>
        </div>
    </section>

    <section id="register-page" class="page hidden">
        <div class="auth-container"><div class="auth-card">
            <h2 class="auth-title">ثبت‌نام</h2>
            <form id="register-form">
                <div class="form-group"><label>ایمیل</label><input type="email" id="reg-email" class="form-control" required></div>
                <div class="form-group"><label>رمز</label><input type="password" id="reg-password" class="form-control" required></div>
                <div class="form-group"><label>تکرار رمز</label><input type="password" id="reg-password-confirm" class="form-control" required></div>
                <div class="form-group"><label>نام</label><input type="text" id="reg-contact" class="form-control" required></div>
                <div class="form-group"><label>تلفن</label><input type="tel" id="reg-phone" class="form-control" required></div>
                <div class="form-group"><label style="display:flex;align-items:center;gap:8px;"><input type="checkbox" id="accept-terms" required> <a href="#" onclick="window.showPage('terms');return false;">قوانین</a> را می‌پذیرم.</label></div>
                <button type="submit" class="btn btn-primary" style="width:100%">ثبت‌نام</button>
            </form>
        </div></div>
    </section>
    <section id="login-page" class="page hidden"><div class="auth-container">...</div></section>
</main>

<footer class="footer"><div class="container"><div class="footer-content"><div class="footer-section"><h3>B2BSteel</h3><p>پلتفرم تخصصی قالب فلزی بتن و سوله</p></div><div class="footer-section"><h3>لینک‌ها</h3><ul><li><a href="#" onclick="window.showPage('home')">خانه</a></li><li><a href="#" onclick="window.showPage('concrete-formwork')">قالب بتن</a></li><li><a href="#" onclick="window.showPage('shed')">سوله</a></li><li><a href="#" onclick="window.showPage('terms')">قوانین</a></li></ul></div></div><div class="footer-bottom"><p>© ۱۴۰۴ B2BSteel</p></div></div></footer>

<script type="importmap">{"imports":{"@supabase/supabase-js":"https://esm.sh/@supabase/supabase-js@2"}}</script>
<script type="module" src="supabaseClient.js"></script>
<script type="module">
    import { supabase } from './supabaseClient.js';
    window.supabase = supabase;
    window.showPage = (id) => {
        document.querySelectorAll('.modal').forEach(m=>m.classList.remove('active'));
        document.querySelectorAll('.page').forEach(p=>p.classList.add('hidden'));
        const target = document.getElementById(id+'-page');
        if(target) target.classList.remove('hidden');
        window.updateNavigation();
    };
    let currentUser = JSON.parse(localStorage.getItem('current_user')) || null;
    window.currentUser = currentUser;
    window.updateNavigation = () => {
        const auth=document.getElementById('auth-buttons'), u=document.getElementById('user-menu'), sf=document.getElementById('seller-formwork-menu'), ss=document.getElementById('seller-shed-menu'), a=document.getElementById('admin-menu');
        if(!auth||!u) return;
        if(currentUser){
            auth.classList.add('hidden');
            if(currentUser.isAdmin) { a?.classList.remove('hidden'); u?.classList.add('hidden'); sf?.classList.add('hidden'); ss?.classList.add('hidden'); }
            else if(currentUser.userType==='buyer') { u?.classList.remove('hidden'); a?.classList.add('hidden'); sf?.classList.add('hidden'); ss?.classList.add('hidden'); }
            else if(currentUser.userType==='seller' && currentUser.sellerType==='formwork') { sf?.classList.remove('hidden'); u?.classList.add('hidden'); a?.classList.add('hidden'); ss?.classList.add('hidden'); }
            else if(currentUser.userType==='seller' && currentUser.sellerType==='shed') { ss?.classList.remove('hidden'); u?.classList.add('hidden'); a?.classList.add('hidden'); sf?.classList.add('hidden'); }
        } else {
            auth.classList.remove('hidden');
            u?.classList.add('hidden'); sf?.classList.add('hidden'); ss?.classList.add('hidden'); a?.classList.add('hidden');
        }
    };
    window.logout = async()=>{ await supabase.auth.signOut(); currentUser=null; localStorage.removeItem('current_user'); window.currentUser=null; window.showPage('home'); alert('خروج موفق'); };

    document.getElementById('register-form')?.addEventListener('submit', async(e)=>{
        e.preventDefault();
        if(!document.getElementById('accept-terms').checked) return alert('پذیرش قوانین الزامی است');
        const pwd=document.getElementById('reg-password').value, conf=document.getElementById('reg-password-confirm').value;
        if(pwd!==conf) return document.getElementById('password-match-error').textContent='رمز مطابقت ندارد';
        const { data, error } = await supabase.auth.signUp({ email: document.getElementById('reg-email').value, password: pwd });
        if(error) alert(error.message); else { alert('ثبت‌نام موفق'); window.showPage('login'); }
    });

    document.getElementById('login-form')?.addEventListener('submit', async(e)=>{
        e.preventDefault();
        const { data, error } = await supabase.auth.signInWithPassword({ email: document.getElementById('login-email').value, password: document.getElementById('login-password').value });
        if(error) alert(error.message); else { 
            const { data: profile } = await supabase.from('profiles').select('*').eq('user_id', data.user.id).single();
            currentUser = { id: data.user.id, email: data.user.email, userType: profile?.user_type, sellerType: profile?.seller_type, full_name: profile?.full_name, isAdmin: profile?.role==='admin' };
            localStorage.setItem('current_user', JSON.stringify(currentUser));
            window.currentUser = currentUser;
            window.updateNavigation();
            if(currentUser.isAdmin) window.showPage('admin');
            else if(currentUser.userType==='buyer') window.showPage('dashboard');
            else if(currentUser.userType==='seller' && currentUser.sellerType==='formwork') window.showPage('seller-formwork-dashboard');
            else if(currentUser.userType==='seller' && currentUser.sellerType==='shed') window.showPage('seller-shed-dashboard');
            else window.showPage('home');
        }
    });

    async function loadCounters() {
        const { count: sellers } = await supabase.from('profiles').select('*', { count: 'exact', head: true }).eq('user_type', 'seller');
        const { count: buyers } = await supabase.from('profiles').select('*', { count: 'exact', head: true }).eq('user_type', 'buyer');
        document.getElementById('counter-sellers').textContent = sellers || 0;
        document.getElementById('counter-buyers').textContent = buyers || 0;
    }

    window.loadDashboard = function() {
        if(!currentUser) return;
        document.getElementById('user-name').textContent = currentUser.full_name || currentUser.email?.split('@')[0] || 'کاربر';
        document.getElementById('user-type').textContent = `نوع حساب: ${currentUser.isAdmin ? 'مدیر' : (currentUser.userType==='seller' ? 'فروشنده' : 'خریدار')}`;
        document.getElementById('user-avatar').textContent = (currentUser.full_name || '?').charAt(0).toUpperCase();
    };

    window.loadSellerShedDashboard = async function() {
        if(!currentUser) return;
        document.getElementById('seller-shed-name').textContent = currentUser.full_name || currentUser.email;
        const { data: requests } = await supabase.from('shed_requests').select('*').eq('status', 'open');
        const container = document.getElementById('seller-shed-requests');
        if(container) container.innerHTML = requests?.map(r=>`<div class="request-item">${r.usage || 'بدون توضیح'}</div>`).join('') || '<p>درخواستی نیست</p>';
    };

    document.addEventListener('DOMContentLoaded', ()=>{
        window.showPage('home');
        loadCounters();
        setInterval(()=>{ document.querySelectorAll('.slider-image').forEach((img,i,a)=>{ img.classList.toggle('active', i===Math.floor(Date.now()/5000)%a.length); }); }, 5000);
    });
</script>
</body>
</html>