<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B2BSteel | پلتفرم تخصصی صنعت فولاد و قالب بتن</title>
    <style>
        /* استایل‌های کلی */
        * {
            font-family: 'Vazirmatn', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #f8fafc;
            color: #333;
            line-height: 1.6;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            cursor: pointer;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ناوبری */
        .navbar {
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            background: #3b82f6;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            color: #1e3a8a;
        }

        .logo-text p {
            font-size: 0.8rem;
            color: #6b7280;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-link {
            color: #4b5563;
            padding: 8px 16px;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .nav-link:hover {
            background: #f3f4f6;
            color: #3b82f6;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
            border: none;
            font-size: 1rem;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.9rem;
        }

        /* صفحه اصلی */
        .hero {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* شمارنده‌ها */
        .counters {
            background: white;
            padding: 3rem 0;
            margin: 2rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .counters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .counter-item {
            text-align: center;
            padding: 1.5rem;
        }

        .counter-number {
            font-size: 3rem;
            font-weight: bold;
            color: #3b82f6;
            margin-bottom: 0.5rem;
        }

        .counter-label {
            font-size: 1.2rem;
            color: #4b5563;
        }

        /* اسلایدشو */
        .image-slider {
            width: 100%;
            height: 500px;
            position: relative;
            overflow: hidden;
            margin: 2rem 0;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .slider-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .slider-image.active {
            opacity: 1;
        }

        .features {
            padding: 4rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            color: #1e3a8a;
            font-size: 2rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            background: #3b82f6;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .feature-card h3 {
            margin-bottom: 1rem;
            color: #1e3a8a;
        }

        /* فرم‌ها */
        .auth-container {
            max-width: 500px;
            margin: 2rem auto;
            padding: 2rem;
        }

        .auth-card {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .auth-title {
            text-align: center;
            margin-bottom: 2rem;
            color: #1e3a8a;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #4b5563;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .user-type-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .user-type-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            background: white;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-type-btn.active {
            border-color: #3b82f6;
            background: #eff6ff;
            color: #3b82f6;
        }

        /* انتخابگر تاریخ */
        .date-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 0.5rem;
        }

        .date-selector select {
            flex: 1;
        }

        /* آپلود عکس */
        .image-upload-container {
            border: 2px dashed #d1d5db;
            border-radius: 6px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-upload-container:hover {
            border-color: #3b82f6;
            background: #f8fafc;
        }

        .image-upload-container i {
            font-size: 3rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .image-preview {
            max-width: 100%;
            max-height: 300px;
            margin-top: 1rem;
            border-radius: 6px;
            display: none;
        }

        .image-preview.active {
            display: block;
        }

        .uploaded-image {
            max-width: 150px;
            max-height: 150px;
            object-fit: cover;
            border-radius: 6px;
            margin: 5px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
        }

        .uploaded-image:hover {
            border-color: #3b82f6;
            transform: scale(1.05);
        }

        /* داشبورد */
        .dashboard {
            padding: 2rem 0;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #3b82f6;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #1e3a8a;
        }

        .dashboard-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .requests-list {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .request-item {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .request-item:last-child {
            border-bottom: none;
        }

        .request-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .request-title {
            font-size: 1.2rem;
            color: #1e3a8a;
        }

        .request-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-open {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-in-progress {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-closed {
            background: #e5e7eb;
            color: #374151;
        }

        .badge-expired {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-selected {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-info {
            background: #dbeafe;
            color: #1e40af;
        }

        .request-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
            color: #6b7280;
            font-size: 0.9rem;
        }

        .request-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* استایل‌های جدید برای انتخاب چندگانه */
        .multi-select {
            width: 100%;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 12px;
            min-height: 120px;
            max-height: 200px;
            overflow-y: auto;
        }

        .multi-select-option {
            padding: 8px 12px;
            margin-bottom: 5px;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.2s;
        }

        .multi-select-option:hover {
            background-color: #f3f4f6;
        }

        .multi-select-option.selected {
            background-color: #eff6ff;
            border-color: #3b82f6;
        }

        .multi-select-option input {
            margin-left: 10px;
        }

        .selected-types-display {
            margin-top: 10px;
            padding: 10px;
            background-color: #f8fafc;
            border-radius: 6px;
            border: 1px dashed #d1d5db;
            min-height: 40px;
        }

        .selected-type-tag {
            display: inline-block;
            background-color: #e0f2fe;
            color: #0369a1;
            padding: 4px 10px;
            border-radius: 20px;
            margin: 3px;
            font-size: 0.85rem;
        }

        /* استایل‌های جدید برای قیمت‌گذاری */
        .price-breakdown {
            background-color: #f8fafc;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #e5e7eb;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #d1d5db;
        }

        .price-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
            font-weight: bold;
            font-size: 1.1rem;
            color: #1e3a8a;
        }

        .price-row.total {
            border-top: 2px solid #3b82f6;
            padding-top: 10px;
            margin-top: 10px;
        }

        /* مودال */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
        }

        /* کمک‌نمای فرم */
        .form-help {
            font-size: 0.85rem;
            color: #6b7280;
            margin-top: 0.25rem;
            margin-bottom: 0.5rem;
        }

        /* پنل ادمین */
        .admin-panel {
            padding: 2rem 0;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .admin-stat-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .admin-stat-card h3 {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .admin-stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #1e3a8a;
        }

        .admin-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        /* بلاگ */
        .blog-page {
            padding: 4rem 0;
        }

        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .blog-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .blog-card:hover {
            transform: translateY(-5px);
        }

        .blog-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .blog-content {
            padding: 1.5rem;
        }

        .blog-title {
            font-size: 1.3rem;
            color: #1e3a8a;
            margin-bottom: 0.5rem;
        }

        .blog-date {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .blog-excerpt {
            color: #4b5563;
            line-height: 1.6;
        }

        .read-more {
            display: inline-block;
            margin-top: 1rem;
            color: #3b82f6;
            font-weight: 600;
        }

        /* استایل‌های جدید برای امتیازدهی */
        .rating-stars {
            display: flex;
            gap: 5px;
            margin: 10px 0;
        }

        .rating-star {
            color: #d1d5db;
            cursor: pointer;
            font-size: 1.5rem;
            transition: color 0.2s;
        }

        .rating-star.active {
            color: #f59e0b;
        }

        .rating-star:hover {
            color: #f59e0b;
        }

        /* بخش سوله */
        .shed-page-container {
            padding: 3rem 0;
        }

        .shed-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .shed-option-card {
            background: white;
            border-radius: 10px;
            padding: 2.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            text-align: center;
            border: 2px solid transparent;
        }

        .shed-option-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
            border-color: #3b82f6;
        }

        .shed-option-icon {
            width: 70px;
            height: 70px;
            background: #3b82f6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 1.8rem;
            color: white;
        }

        .shed-form-section {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .shed-form-section h3 {
            color: #1e3a8a;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #f1f5f9;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .shed-form-section h3 i {
            color: #3b82f6;
        }

        .dimensions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin: 1rem 0;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"],
        .checkbox-item input[type="radio"] {
            width: 18px;
            height: 18px;
        }

        /* سوله دست دوم */
        .shed-listings {
            margin: 2rem 0;
        }

        .shed-listing-item {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .shed-listing-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .shed-listing-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .shed-listing-title {
            font-size: 1.2rem;
            color: #1e3a8a;
            font-weight: 600;
        }

        .shed-listing-price {
            font-size: 1.3rem;
            color: #059669;
            font-weight: bold;
        }

        .shed-listing-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            color: #6b7280;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .shed-listing-features {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .shed-feature-tag {
            background: #f1f5f9;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: #4b5563;
        }

        /* صفحه بازاریابی */
        .marketing-hero {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 6rem 0;
            text-align: center;
        }

        .marketing-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .marketing-hero p {
            font-size: 1.4rem;
            margin-bottom: 2rem;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        .benefits-section {
            padding: 5rem 0;
            background: #f8fafc;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 3rem;
            margin-top: 3rem;
        }

        .benefit-card {
            background: white;
            border-radius: 15px;
            padding: 2.5rem;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .benefit-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }

        .benefit-icon {
            width: 80px;
            height: 80px;
            background: #3b82f6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
        }

        .benefit-card h3 {
            color: #1e3a8a;
            margin-bottom: 1rem;
            text-align: center;
            font-size: 1.5rem;
        }

        .benefit-list {
            list-style: none;
            margin-top: 1.5rem;
        }

        .benefit-list li {
            padding: 0.8rem 0;
            border-bottom: 1px dashed #e5e7eb;
            display: flex;
            align-items: center;
        }

        .benefit-list li:last-child {
            border-bottom: none;
        }

        .benefit-list i {
            color: #10b981;
            margin-left: 10px;
        }

        .cta-section {
            padding: 6rem 0;
            text-align: center;
            background: linear-gradient(135deg, #047857 0%, #10b981 100%);
            color: white;
        }

        .cta-section h2 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
        }

        .cta-section p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .testimonials {
            padding: 5rem 0;
            background: white;
        }

        .testimonial-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .testimonial-card {
            background: #f8fafc;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .testimonial-text {
            font-style: italic;
            margin-bottom: 1.5rem;
            color: #4b5563;
        }

        .testimonial-author {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .testimonial-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #3b82f6;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .testimonial-info h4 {
            color: #1e3a8a;
            margin-bottom: 0.25rem;
        }

        /* شمارنده با جداکننده اتوماتیک */
        .formatted-number {
            direction: ltr;
            text-align: left;
        }

        /* فوتر */
        .footer {
            background: #1e293b;
            color: white;
            padding: 3rem 0;
            margin-top: 4rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: #e5e7eb;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
        }

        .footer-section a {
            color: #9ca3af;
            transition: color 0.3s;
        }

        .footer-section a:hover {
            color: white;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid #374151;
            color: #9ca3af;
        }

        /* حالت‌های نمایش */
        .hidden {
            display: none !important;
        }

        /* رسپانسیو */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }

            .hero h2 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            
            .image-slider {
                height: 300px;
            }
            
            .price-row {
                flex-direction: column;
                gap: 5px;
            }
            
            .counter-number {
                font-size: 2rem;
            }
            
            .date-selector {
                flex-direction: column;
            }
            
            .marketing-hero h1 {
                font-size: 2rem;
            }
            
            .marketing-hero p {
                font-size: 1.1rem;
            }
            
            .benefits-grid {
                grid-template-columns: 1fr;
            }
            
            .cta-section h2 {
                font-size: 2rem;
            }
            
            .shed-options {
                grid-template-columns: 1fr;
            }
            
            .dimensions-grid {
                grid-template-columns: 1fr;
            }
            
            .checkbox-group {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- B2BSteel brand variables and minimal style overrides -->
<style>
:root{
    --primary: #004586;      /* آبی فولادی */
    --primary-dark: #003366;
    --accent: #E6B800;       /* طلایی صنعتی */
    --bg: #F7F7F7;           /* زمینه کلی */
    --muted: #6b7280;
    --text-dark: #2A2A2A;
    --card-bg: #FFFFFF;
}

/* Ensure buttons, links, and accent elements use brand colors where sensible */
.btn-primary, .btn.btn-primary { background: var(--primary) !important; color: #fff !important; border: none !important; }
.btn-primary:hover { background: var(--primary-dark) !important; }
.btn-warning, .btn.btn-warning { background: var(--accent) !important; color: #fff !important; }

/* Hero override if present */
.hero { background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%) !important; color: white !important; }

/* Logo text override */
.logo-text h1 { color: var(--primary) !important; font-weight:700 !important; }
.logo-text p { color: var(--muted) !important; }

/* Small helper to make svg logos print/scale nicely */
.logo-icon svg { width: 56px; height: 56px; display: block; }
</style>


<!-- Enhanced professional B2BSteel visual styles -->
<style>
:root{
  --primary:#004586;
  --primary-dark:#002f5c;
  --accent:#E6B800;
  --dark:#1E1E1E;
  --bg:#F7F7F7;
  --card-bg:#FFFFFF;
  --muted:#6b7280;
}
body{background:var(--bg);color:var(--dark);font-family:'Vazirmatn',sans-serif;scroll-behavior:smooth;}
.navbar{background:var(--card-bg);box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:all .3s;}
.navbar:hover{box-shadow:0 3px 10px rgba(0,0,0,0.15);}
.btn-primary{background:var(--primary);color:#fff;border:none;transition:all .3s;}
.btn-primary:hover{background:var(--primary-dark);transform:translateY(-2px);}
.btn-accent{background:var(--accent);color:#fff;border:none;transition:all .3s;}
.btn-accent:hover{filter:brightness(1.1);transform:translateY(-2px);}
.hero{background:linear-gradient(135deg,var(--primary-dark),var(--primary));color:#fff;padding:6rem 0;text-align:center;position:relative;overflow:hidden;}
.hero::after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 20%,rgba(230,184,0,0.15),transparent 70%),radial-gradient(circle at 80% 80%,rgba(0,69,134,0.2),transparent 70%);z-index:0;}
.hero .container{position:relative;z-index:1;}
.hero h2{font-size:2.8rem;margin-bottom:1rem;font-weight:700;}
.hero p{font-size:1.2rem;opacity:.95;}
.feature-card{background:var(--card-bg);border-radius:14px;padding:2rem;box-shadow:0 4px 8px rgba(0,0,0,0.06);transition:all .35s;}
.feature-card:hover{transform:translateY(-6px);box-shadow:0 6px 16px rgba(0,0,0,0.1);}
.feature-icon{width:70px;height:70px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.7rem;margin-bottom:1rem;}
.footer{background:var(--primary-dark);color:#ddd;padding:4rem 0;}
.footer h3{color:var(--accent);margin-bottom:1rem;}
.footer a{color:#ccc;text-decoration:none;transition:color .2s;}
.footer a:hover{color:var(--accent);}
.fade-in{opacity:0;transform:translateY(20px);animation:fadeIn .8s ease forwards;}
@keyframes fadeIn{to{opacity:1;transform:translateY(0);}}
</style>

</head>
<body>
    <!-- ناوبری اصلی - شامل هر دو بخش -->
    <nav class="navbar">
        <div class="container nav-container">
            <div class="logo">
    
<!-- B2BSteel minimal SVG logo (print-friendly) -->
<div class="logo-icon" aria-hidden="true">
<svg width="56" height="56" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="B2BSteel logo">
    <defs>
        <style>
            .ln{stroke:var(--primary);stroke-width:3;stroke-linecap:round;stroke-linejoin:round;fill:none}
            .node{fill:var(--primary);stroke:#ffffff;stroke-width:1}
            .center{fill:var(--accent);stroke:#ffffff;stroke-width:1}
        </style>
    </defs>
    <polygon class="ln" points="32 6 52 16 52 38 32 50 12 38 12 16"/>
    <line class="ln" x1="32" y1="6" x2="32" y2="50"/>
    <line class="ln" x1="12" y1="16" x2="52" y2="38"/>
    <line class="ln" x1="12" y1="38" x2="52" y2="16"/>
    <circle class="node" cx="32" cy="6" r="3.6"/>
    <circle class="node" cx="52" cy="16" r="3.6"/>
    <circle class="node" cx="52" cy="38" r="3.6"/>
    <circle class="node" cx="32" cy="50" r="3.6"/>
    <circle class="node" cx="12" cy="38" r="3.6"/>
    <circle class="node" cx="12" cy="16" r="3.6"/>
    <circle class="center" cx="32" cy="32" r="4.5"/>
</svg>
</div>

    <div class="logo-text">
        <h1>B2BSteel</h1>
        <p>Connect. Build. Trust.</p>
    </div>
</div>
                <div class="logo-text">
                    <h1>B2BSteel</h1>
                    <p>پلتفرم تخصصی قالب فلزی بتن و سوله</p>
                </div>
            </div>
            <div class="nav-links">
                <a href="#" class="nav-link" onclick="showPage('home')">خانه</a>
                <a href="#" class="nav-link" onclick="showPage('concrete-formwork')">قالب بتن</a>
                <a href="#" class="nav-link" onclick="showPage('shed')">سوله</a>
                <a href="#" class="nav-link" onclick="showPage('marketing')">چرا B2BSteel؟</a>
                <a href="#" class="nav-link" onclick="showPage('features')">امکانات</a>
                <a href="#" class="nav-link" onclick="showPage('how-it-works')">نحوه کار</a>
                <a href="#" class="nav-link" onclick="showPage('blog')">بلاگ</a>
                <div id="auth-buttons">
                    <button class="btn btn-primary" onclick="showPage('login')">ورود</button>
                    <button class="btn btn-secondary" onclick="showPage('register')">ثبت‌نام</button>
                </div>
                <div id="user-menu" class="hidden">
                    <button class="btn btn-primary" onclick="showPage('dashboard')">داشبورد</button>
                    <button class="btn btn-danger" onclick="logout()">خروج</button>
                </div>
                <div id="seller-formwork-menu" class="hidden">
                    <button class="btn btn-primary" onclick="showPage('seller-formwork-dashboard')">داشبورد فروشنده قالب</button>
                    <button class="btn btn-danger" onclick="logout()">خروج</button>
                </div>
                <div id="seller-shed-menu" class="hidden">
                    <button class="btn btn-success" onclick="showPage('seller-shed-dashboard')">داشبورد فروشنده سوله</button>
                    <button class="btn btn-danger" onclick="logout()">خروج</button>
                </div>
                <div id="admin-menu" class="hidden">
                    <button class="btn btn-warning" onclick="showPage('admin')">پنل ادمین</button>
                    <button class="btn btn-primary" onclick="showPage('dashboard')">داشبورد</button>
                    <button class="btn btn-danger" onclick="logout()">خروج</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- صفحات -->
    <main id="pages">
        <!-- صفحه اصلی -->
        <section id="home-page" class="page">
            <div class="hero fade-in">
                <div class="container">
                    <h2>ارتباط مستقیم خریدار و فروشنده قالب فلزی بتن و سوله</h2>
                    <p>حریم خصوصی محفوظ | تایید هویت اعضا | شفافیت قیمت</p>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" style="padding: 15px 30px; font-size: 1.1rem;" onclick="showPage('register')">
                            <i class="fas fa-user-tie"></i> من خریدار هستم
                        </button>
                        <button class="btn btn-success" style="padding: 15px 30px; font-size: 1.1rem;" onclick="showPage('register')">
                            <i class="fas fa-industry"></i> من فروشنده هستم
                        </button>
                    </div>
                </div>
            </div>

            <!-- شمارنده‌ها -->
            <div class="counters">
                <div class="container">
                    <div class="counters-grid">
                        <div class="counter-item">
                            <div class="counter-number" id="counter-sellers">۱۲</div>
                            <div class="counter-label">فروشنده ثبت‌نام شده</div>
                        </div>
                        <div class="counter-item">
                            <div class="counter-number" id="counter-buyers">۲۵</div>
                            <div class="counter-label">خریدار ثبت‌نام شده</div>
                        </div>
                        <div class="counter-item">
                            <div class="counter-number" id="counter-transactions">۴۷</div>
                            <div class="counter-label">فروش نهایی شده</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- اسلایدشو عکس -->
            <div class="container">
                <div class="image-slider">
                    <img src="https://img.edilportale.com/product-thumbs/b_P300-Pilosio-611087-rel51b5c439.jpg" 
                         alt="قالب فلزی بتن" class="slider-image active">
                    <img src="https://img.edilportale.com/product-thumbs/b_P300-Pilosio-611087-rel991e93b7.jpg" 
                         alt="قالب فلزی بتن" class="slider-image">
                    <div class="slider-image" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                        <div style="text-align: center;">
                            <i class="fas fa-industry" style="font-size: 4rem; margin-bottom: 1rem;"></i>
                            <p>صنعت ساختمان</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="features">
                <div class="container">
                    <h2 class="section-title">چرا B2BSteel؟</h2>
                    <div class="features-grid">
                        <div class="feature-card fade-in">
                            <div class="feature-icon">
                                <i class="fas fa-lock"></i>
                            </div>
                            <h3>حریم خصوصی کاملاً محفوظ</h3>
                            <p>اطلاعات هویتی فروشندگان تا زمان انتخاب نهایی مخفی می‌ماند. خریداران می‌توانند با خیال راحت پیشنهادها را مقایسه کنند بدون اینکه نگران افشای اطلاعات تماس فروشندگان باشند.</p>
                        </div>
                        <div class="feature-card fade-in">
                            <div class="feature-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3>شفافیت کامل قیمت</h3>
                            <p>خریدار می‌تواند تمام پیشنهادات قیمت را به صورت شفاف مشاهده و مقایسه کند. سیستم قیمت‌گذاری دقیق و شفاف باعث رقابت سالم و قیمت‌های منصفانه می‌شود.</p>
                        </div>
                        <div class="feature-card fade-in">
                            <div class="feature-icon">
                                <i class="fas fa-handshake"></i>
                            </div>
                            <h3>ارتباط مستقیم و سریع</h3>
                            <p>ایجاد ارتباط مستقیم بین خریداران و فروشندگان معتبر بدون واسطه. کاهش زمان مذاکرات و معاملات با حذف دلالان و واسطه‌های غیرضروری.</p>
                        </div>
                        <div class="feature-card fade-in">
                            <div class="feature-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3>تایید هویت اعضا</h3>
                            <p>تمام اعضا پس از بررسی مدارک تایید می‌شوند تا از صحت و اعتبار آنها اطمینان حاصل شود. سیستم امتیازدهی و نظرات برای افزایش اعتماد بین کاربران.</p>
                        </div>
                        <div class="feature-card fade-in">
                            <div class="feature-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <h3>گارانتی و تضمین کیفیت</h3>
                            <p>تمام فروشندگان متعهد به ارائه گارانتی محصولات هستند. سیستم امتیازدهی باعث می‌شود فروشندگان برای حفظ رتبه خود کیفیت را در اولویت قرار دهند.</p>
                        </div>
                        <div class="feature-card fade-in">
                            <div class="feature-icon">
                                <i class="fas fa-headset"></i>
                            </div>
                            <h3>پشتیبانی ۲۴ ساعته</h3>
                            <p>تیم پشتیبانی ما به صورت ۲۴ ساعته آماده پاسخگویی به سوالات و حل مشکلات شماست. تضمین می‌کنیم که هیچ درخواستی بدون پاسخ نمی‌ماند.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه قالب بتن -->
        <section id="concrete-formwork-page" class="page hidden">
            <div class="hero fade-in">
                <div class="container">
                    <h2>بخش قالب فلزی بتن</h2>
                    <p>خرید و فروش تخصصی انواع قالب فلزی بتن</p>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" style="padding: 15px 30px; font-size: 1.1rem;" onclick="showPage('register')">
                            <i class="fas fa-user-tie"></i> من خریدار هستم
                        </button>
                        <button class="btn btn-success" style="padding: 15px 30px; font-size: 1.1rem;" onclick="showPage('register')">
                            <i class="fas fa-industry"></i> من فروشنده هستم
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="container" style="padding: 4rem 0;">
                <div class="features-grid">
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-cube"></i>
                        </div>
                        <h3>قالب مدولار</h3>
                        <p>قالب‌بندی سریع و با کیفیت برای پروژه‌های مختلف ساختمانی</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-building"></i>
                        </div>
                        <h3>قالب دیوار و ستون</h3>
                        <p>قالب‌های مخصوص دیوار و ستون با مقاومت بالا و دوام طولانی</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-bridge"></i>
                        </div>
                        <h3>قالب تونل و پل</h3>
                        <p>قالب‌های تخصصی برای پروژه‌های بزرگ عمرانی</p>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 3rem;">
                    <p style="color: #6b7280; margin-bottom: 2rem; max-width: 800px; margin-left: auto; margin-right: auto;">
                        سیستم کامل قالب بتن شامل ثبت‌نام، پرسشنامه تخصصی، پیشنهاد قیمت، مذاکره و انجام معامله در محیطی امن و شفاف
                    </p>
                    <button class="btn btn-primary" style="padding: 15px 40px; font-size: 1.2rem;" onclick="enterConcreteFormworkSystem()">
                        <i class="fas fa-sign-in-alt"></i> ورود به سیستم قالب بتن
                    </button>
                </div>
            </div>
        </section>

        <!-- صفحه سوله -->
        <section id="shed-page" class="page hidden">
            <div class="container shed-page-container">
                <h2 class="section-title">بخش سوله</h2>
                <p class="text-center" style="color: #6b7280; max-width: 800px; margin: 0 auto 2rem;">
                    انتخاب خدمات مورد نیاز خود در حوزه سوله
                </p>
                
                <div class="shed-options">
                    <div class="shed-option-card" style="background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)), url('https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80&blend=ffffff&blend-alpha=10&blend-mode=multiply'); background-size: cover; background-position: center;">
                        <div class="shed-option-icon">
                            <i class="fas fa-plus-circle"></i>
                        </div>
                        <h3 style="color: #1e3a8a; margin-bottom: 1rem;">سوله نو</h3>
                        <p style="color: #6b7280; margin-bottom: 1.5rem; line-height: 1.6;">
                            طراحی و ساخت سوله نو با استانداردهای روز و استفاده از بهترین متریال
                        </p>
                        <ul style="text-align: right; list-style: none; margin-bottom: 2rem; color: #4b5563;">
                            <li style="padding: 0.5rem 0;">
                                <i class="fas fa-check" style="color: #10b981; margin-left: 10px;"></i>
                                طراحی مهندسی اختصاصی
                            </li>
                            <li style="padding: 0.5rem 0;">
                                <i class="fas fa-check" style="color: #10b981; margin-left: 10px;"></i>
                                استفاده از فولاد با کیفیت
                            </li>
                            <li style="padding: 0.5rem 0;">
                                <i class="fas fa-check" style="color: #10b981; margin-left: 10px;"></i>
                                نصب و راه‌اندازی کامل
                            </li>
                        </ul>
                        <button class="btn btn-primary" onclick="showPage('new-shed-request')" style="width: 100%;">
                            <i class="fas fa-file-alt"></i> پر کردن پرسشنامه سوله نو
                        </button>
                    </div>
                    
                    <div class="shed-option-card">
                        <div class="shed-option-icon">
                            <i class="fas fa-warehouse"></i>
                        </div>
                        <h3 style="color: #1e3a8a; margin-bottom: 1rem;">سوله دست دوم</h3>
                        <p style="color: #6b7280; margin-bottom: 1.5rem; line-height: 1.6;">
                            بازار تخصصی خرید و فروش سوله‌های دست دوم با بازرسی فنی
                        </p>
                        <ul style="text-align: right; list-style: none; margin-bottom: 2rem; color: #4b5563;">
                            <li style="padding: 0.5rem 0;">
                                <i class="fas fa-check" style="color: #10b981; margin-left: 10px;"></i>
                                بازرسی فنی دقیق
                            </li>
                            <li style="padding: 0.5rem 0;">
                                <i class="fas fa-check" style="color: #10b981; margin-left: 10px;"></i>
                                قیمت‌گذاری کارشناسی
                            </li>
                            <li style="padding: 0.5rem 0;">
                                <i class="fas fa-check" style="color: #10b981; margin-left: 10px;"></i>
                                خدمات تخریب و حمل
                            </li>
                        </ul>
                        <button class="btn btn-success" onclick="loadSecondhandSheds()" style="width: 100%;">
                            <i class="fas fa-search"></i> مشاهده آگهی‌های سوله دست دوم
                        </button>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-secondary" onclick="showPage('home')">
                        <i class="fas fa-arrow-right"></i> بازگشت به صفحه اصلی
                    </button>
                </div>
            </div>
        </section>

        <!-- صفحه درخواست سوله نو -->
        <section id="new-shed-request-page" class="page hidden">
            <div class="container">
                <div style="max-width: 800px; margin: 0 auto; padding: 2rem 0;">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <h1 style="color: #1e3a8a; margin-bottom: 0.5rem;">پرسشنامه درخواست سوله نو</h1>
                        <p style="color: #6b7280;">لطفاً اطلاعات پروژه خود را با دقت وارد کنید</p>
                    </div>
                    
                    <form id="new-shed-form">
                        <!-- بخش ابعاد سوله -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-ruler-combined"></i> ابعاد سوله</h3>
                            <div class="dimensions-grid">
                                <div class="form-group">
                                    <label for="shed-length">طول سوله (متر)</label>
                                    <input type="number" id="shed-length" class="form-control" required min="10" step="0.5" placeholder="مثال: 100">
                                </div>
                                <div class="form-group">
                                    <label for="shed-width">عرض سوله (متر)</label>
                                    <input type="number" id="shed-width" class="form-control" required min="10" step="0.5" placeholder="مثال: 30">
                                </div>
                                <div class="form-group">
                                    <label for="shed-height">ارتفاع کنار سوله (متر)</label>
                                    <input type="number" id="shed-height" class="form-control" required min="4" step="0.5" placeholder="مثال: 6">
                                </div>
                            </div>
                        </div>
                        
                        <!-- بخش نقشه سازه -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-drafting-compass"></i> نقشه سازه</h3>
                            <div class="form-group">
                                <label>آیا فایل نقشه سازه دارید؟</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" id="has-drawing-yes" name="has-drawing" value="yes" onclick="toggleDrawingUpload(true)">
                                        <label for="has-drawing-yes">بله، دارم</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" id="has-drawing-no" name="has-drawing" value="no" checked onclick="toggleDrawingUpload(false)">
                                        <label for="has-drawing-no">خیر، نیاز به طراحی دارم</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="drawing-upload-section" class="hidden">
                                <div class="form-group">
                                    <label for="shed-drawing">آپلود فایل نقشه (اختیاری)</label>
                                    <input type="file" id="shed-drawing" class="form-control" accept=".pdf,.dwg,.jpg,.jpeg,.png">
                                    <small style="color: #6b7280; display: block; margin-top: 5px;">فرمت‌های مجاز: PDF, DWG, JPG, PNG</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- بخش اطلاعات پروژه -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-info-circle"></i> اطلاعات پروژه</h3>
                            <div class="form-group">
                                <label for="shed-usage">کارکرد سوله</label>
                                <textarea id="shed-usage" class="form-control" rows="3" required placeholder="برای چه منظوری نیاز به سوله دارید؟ (مثال: انبار، کارگاه تولیدی، تعمیرگاه و ...)"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="shed-location">محل نصب سوله</label>
                                <input type="text" id="shed-location" class="form-control" required placeholder="استان، شهر، آدرس دقیق">
                            </div>
                        </div>
                        
                        <!-- بخش جرثقیل سقفی -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-crane"></i> جرثقیل سقفی</h3>
                            <div class="form-group">
                                <label>آیا به جرثقیل سقفی نیاز دارید؟</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" id="needs-crane-yes" name="needs-crane" value="yes" onclick="toggleCraneDetails(true)">
                                        <label for="needs-crane-yes">بله، نیاز دارم</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" id="needs-crane-no" name="needs-crane" value="no" checked onclick="toggleCraneDetails(false)">
                                        <label for="needs-crane-no">خیر، نیازی نیست</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="crane-details-section" class="hidden">
                                <div class="form-group">
                                    <label for="crane-tonnage">تناژ جرثقیل سقفی پیش‌بینی شده (تن)</label>
                                    <input type="number" id="crane-tonnage" class="form-control" min="1" max="100" step="0.5" placeholder="مثال: 5">
                                </div>
                            </div>
                        </div>
                        
                        <!-- بخش فونداسیون -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-layer-group"></i> فونداسیون</h3>
                            <div class="form-group">
                                <label>آیا فونداسیون آماده است؟</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" id="foundation-yes" name="foundation" value="yes">
                                        <label for="foundation-yes">بله، آماده است</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" id="foundation-no" name="foundation" value="no" checked>
                                        <label for="foundation-no">خیر، نیاز به اجرا دارم</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- بخش سندبلاست و رنگ -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-paint-roller"></i> سندبلاست و رنگ</h3>
                            <div class="form-group">
                                <label>آیا به سندبلاست نیاز دارید؟</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" id="sandblast-yes" name="sandblast" value="yes">
                                        <label for="sandblast-yes">بله</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" id="sandblast-no" name="sandblast" value="no" checked>
                                        <label for="sandblast-no">خیر</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="paint-type">نوع رنگ مورد نیاز</label>
                                <select id="paint-type" class="form-control" onchange="toggleOtherPaintType()">
                                    <option value="">انتخاب کنید</option>
                                    <option value="ضد زنگ">ضد زنگ</option>
                                    <option value="آلکیدی">آلکیدی</option>
                                    <option value="زینک ریچ">زینک ریچ</option>
                                    <option value="اپوکسی">اپوکسی</option>
                                    <option value="other">سایر</option>
                                </select>
                                <input type="text" id="other-paint-type" class="form-control hidden" placeholder="نوع رنگ را وارد کنید" style="margin-top: 10px;">
                            </div>
                            
                            <div class="form-group">
                                <label for="paint-thickness">ضخامت رنگ مورد نیاز (میکرون)</label>
                                <input type="number" id="paint-thickness" class="form-control" value="50" min="20" max="200" step="5">
                                <small style="color: #6b7280; display: block; margin-top: 5px;">ضخامت استاندارد رنگ برای سوله‌ها بین ۵۰ تا ۱۰۰ میکرون است</small>
                            </div>
                        </div>
                        
                        <!-- بخش مسئولیت‌های خریدار (با گزینه‌های محدود) -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-tasks"></i> مسئولیت‌های خریدار</h3>
                            <p style="color: #6b7280; margin-bottom: 1rem;">لطفاً مواردی که خودتان به عهده می‌گیرید را انتخاب کنید:</p>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="responsibility-steel" name="responsibility" value="steel">
                                    <label for="responsibility-steel">تهیه آهن آلات</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="responsibility-bolts" name="responsibility" value="bolts">
                                    <label for="responsibility-bolts">تهیه پیچ و مهره</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="responsibility-transport" name="responsibility" value="transport">
                                    <label for="responsibility-transport">حمل</label>
                                </div>
                            </div>
                            <small style="color: #6b7280; display: block; margin-top: 10px;">توجه: سایر خدمات مانند طراحی، ساخت، سندبلاست، رنگ آمیزی و نصب بر عهده فروشنده خواهد بود</small>
                        </div>
                        
                        <!-- بخش وزن و قیمت -->
                        <div class="shed-form-section">
                            <h3><i class="fas fa-balance-scale"></i> وزن و قیمت</h3>
                            <div class="form-group">
                                <label for="shed-weight">وزن سوله (تن) - در صورت اطلاع</label>
                                <input type="number" id="shed-weight" class="form-control" min="1" step="0.1" placeholder="وزن تقریبی سوله">
                            </div>
                            
                            <div class="form-group">
                                <label>نوع قیمت‌گذاری مورد نظر</label>
                                <div class="checkbox-group">
                                    <div class="checkbox-item">
                                        <input type="radio" id="price-type-estimated" name="price-type" value="estimated" checked>
                                        <label for="price-type-estimated">قیمت حدودی</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="radio" id="price-type-exact" name="price-type" value="exact">
                                        <label for="price-type-exact">قیمت دقیق</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- دکمه‌های ارسال و بازگشت -->
                        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
                            <button type="button" class="btn btn-secondary" onclick="showPage('shed')">
                                <i class="fas fa-arrow-right"></i> بازگشت
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> ارسال درخواست
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- صفحه سوله دست دوم -->
        <section id="secondhand-shed-page" class="page hidden">
            <div class="container shed-page-container">
                <h2 class="section-title">آگهی‌های سوله دست دوم</h2>
                <p class="text-center" style="color: #6b7280; max-width: 800px; margin: 0 auto 2rem;">
                    لیست سوله‌های دست دوم موجود در بازار با مشخصات کامل
                </p>
                
                <div id="shed-listings" class="shed-listings">
                    <!-- آگهی‌ها به صورت دینامیک بارگذاری می‌شوند -->
                </div>
                
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-secondary" onclick="showPage('shed')">
                        <i class="fas fa-arrow-right"></i> بازگشت به بخش سوله
                    </button>
                </div>
            </div>
        </section>

        <!-- ==================== سیستم کامل قالب بتن ==================== -->
        
        <!-- صفحه ثبت‌نام -->
        <section id="register-page" class="page hidden">
            <div class="auth-container">
                <div class="auth-card">
                    <h2 class="auth-title">ثبت‌نام در B2BSteel</h2>
                    
                    <div class="user-type-selector" id="user-type-main-selector">
                        <div class="user-type-btn active" data-type="buyer" onclick="selectUserType('buyer')">
                            <i class="fas fa-user-tie"></i>
                            <p>خریدار</p>
                        </div>
                        <div class="user-type-btn" data-type="seller" onclick="selectUserType('seller')">
                            <i class="fas fa-industry"></i>
                            <p>فروشنده</p>
                        </div>
                    </div>
                    
                    <!-- انتخاب نوع کاربر (حقیقی/حقوقی) -->
                    <div class="form-group">
                        <label>نوع کاربر</label>
                        <div class="user-type-selector" id="user-legal-type-selector">
                            <div class="user-type-btn" data-type="individual" onclick="selectUserLegalType('individual')">
                                <i class="fas fa-user"></i>
                                <p>شخص حقیقی</p>
                            </div>
                            <div class="user-type-btn active" data-type="company" onclick="selectUserLegalType('company')">
                                <i class="fas fa-building"></i>
                                <p>شرکت/حقوقی</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- انتخاب نوع فروشنده (قالب یا سوله) -->
                    <div id="seller-type-section" class="form-group hidden">
                        <label>نوع فروشنده</label>
                        <div class="user-type-selector" id="seller-type-selector">
                            <div class="user-type-btn active" data-type="formwork" onclick="selectSellerType('formwork')">
                                <i class="fas fa-cubes"></i>
                                <p>فروشنده قالب</p>
                            </div>
                            <div class="user-type-btn" data-type="shed" onclick="selectSellerType('shed')">
                                <i class="fas fa-warehouse"></i>
                                <p>فروشنده سوله</p>
                            </div>
                        </div>
                    </div>
                    
                    <form id="register-form">
                        <div class="form-group">
                            <label for="reg-email">ایمیل</label>
                            <input type="email" id="reg-email" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="reg-password">رمز عبور</label>
                            <input type="password" id="reg-password" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="reg-password-confirm">تکرار رمز عبور</label>
                            <input type="password" id="reg-password-confirm" class="form-control" required>
                            <div id="password-match-error" class="error-message" style="color: red; font-size: 0.85rem; margin-top: 5px;"></div>
                        </div>
                        
                        <div id="company-fields" class="company-fields">
                            <div class="form-group">
                                <label for="reg-company" id="company-label">نام شرکت</label>
                                <input type="text" id="reg-company" class="form-control" placeholder="مثال: شرکت ساختمانی پیشرو">
                                <div class="form-help">در صورت حقیقی بودن، نام شرکت محل کار خود را وارد کنید (اختیاری)</div>
                            </div>
                            
                            <div class="form-group">
                                <label for="reg-position">سمت سازمانی (اختیاری)</label>
                                <input type="text" id="reg-position" class="form-control" placeholder="مثال: مدیر بازرگانی">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="reg-contact">نام شخص رابط</label>
                            <input type="text" id="reg-contact" class="form-control" required placeholder="نام و نام خانوادگی">
                        </div>
                        
                        <div class="form-group">
                            <label for="reg-phone">تلفن تماس</label>
                            <input type="tel" id="reg-phone" class="form-control" required placeholder="۰۹۱۲۱۲۳۴۵۶۷">
                        </div>
                        
                        <div id="register-error" class="error-message" style="color: red; margin-bottom: 1rem;"></div>
                        
                        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px;">ثبت‌نام</button>
                    </form>
                    
                    <p style="text-align: center; margin-top: 1rem;">
                        قبلاً حساب دارید؟ <a href="#" onclick="showPage('login')" style="color: #3b82f6;">وارد شوید</a>
                    </p>
                </div>
            </div>
        </section>

        <!-- صفحه ورود -->
        <section id="login-page" class="page hidden">
            <div class="auth-container">
                <div class="auth-card">
                    <h2 class="auth-title">ورود به حساب کاربری</h2>
                    
                    <form id="login-form">
                        <div class="form-group">
                            <label for="login-email">ایمیل</label>
                            <input type="email" id="login-email" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="login-password">رمز عبور</label>
                            <input type="password" id="login-password" class="form-control" required>
                        </div>
                        
                        <div id="login-error" class="error-message" style="color: red; margin-bottom: 1rem;"></div>
                        
                        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px;">ورود</button>
                    </form>
                    
                    <p style="text-align: center; margin-top: 1rem;">
                        حساب ندارید؟ <a href="#" onclick="showPage('register')" style="color: #3b82f6;">ثبت‌نام کنید</a>
                    </p>
                </div>
            </div>
        </section>

        <!-- صفحه داشبورد خریدار -->
        <section id="dashboard-page" class="page hidden">
            <div class="container dashboard">
                <div class="dashboard-header">
                    <div class="user-info">
                        <div class="user-avatar" id="user-avatar">?</div>
                        <div>
                            <h2 id="user-name">کاربر عزیز</h2>
                            <p id="user-type">نوع حساب: در حال بارگذاری...</p>
                        </div>
                    </div>
                    <div id="buyer-actions" class="hidden">
                        <button class="btn btn-primary" onclick="showNewRequestModal()">
                            <i class="fas fa-plus"></i> ایجاد درخواست جدید
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid" id="dashboard-stats">
                    <!-- آمار به صورت دینامیک بارگذاری می‌شود -->
                </div>
                
                <div class="dashboard-actions">
                    <button class="btn btn-secondary" onclick="loadAllRequests()">
                        <i class="fas fa-list"></i> همه درخواست‌ها
                    </button>
                    <button class="btn btn-primary" onclick="showNewRequestModal()">
                        <i class="fas fa-plus"></i> ایجاد درخواست جدید
                    </button>
                    <button class="btn btn-info" onclick="loadShedRequests()">
                        <i class="fas fa-warehouse"></i> درخواست‌های سوله
                    </button>
                </div>
                
                <div id="dashboard-content">
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">لطفاً یک گزینه از بالا انتخاب کنید.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه پنل ادمین -->
        <section id="admin-page" class="page hidden">
            <div class="container admin-panel">
                <h2 class="section-title">پنل مدیریت ادمین</h2>
                
                <div class="admin-stats">
                    <div class="admin-stat-card">
                        <h3>تعداد کل کاربران</h3>
                        <div class="value" id="admin-total-users">۰</div>
                    </div>
                    <div class="admin-stat-card">
                        <h3>تعداد خریداران</h3>
                        <div class="value" id="admin-total-buyers">۰</div>
                    </div>
                    <div class="admin-stat-card">
                        <h3>تعداد فروشندگان قالب</h3>
                        <div class="value" id="admin-formwork-sellers">۰</div>
                    </div>
                    <div class="admin-stat-card">
                        <h3>تعداد فروشندگان سوله</h3>
                        <div class="value" id="admin-shed-sellers">۰</div>
                    </div>
                    <div class="admin-stat-card">
                        <h3>تعداد درخواست‌ها</h3>
                        <div class="value" id="admin-total-requests">۰</div>
                    </div>
                    <div class="admin-stat-card">
                        <h3>تراکنش‌های موفق</h3>
                        <div class="value" id="admin-total-transactions">۰</div>
                    </div>
                </div>
                
                <div class="admin-actions">
                    <button class="btn btn-primary" onclick="loadAllUsers()">
                        <i class="fas fa-users"></i> مدیریت کاربران
                    </button>
                    <button class="btn btn-primary" onclick="loadAllRequests()">
                        <i class="fas fa-clipboard-list"></i> مشاهده تمام درخواست‌ها
                    </button>
                    <button class="btn btn-primary" onclick="loadAllShedRequests()">
                        <i class="fas fa-warehouse"></i> درخواست‌های سوله
                    </button>
                    <button class="btn btn-primary" onclick="loadAllTransactions()">
                        <i class="fas fa-exchange-alt"></i> مشاهده تراکنش‌ها
                    </button>
                </div>
                
                <div id="admin-content">
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">لطفاً یک گزینه از بالا انتخاب کنید.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه بلاگ -->
        <section id="blog-page" class="page hidden">
            <div class="container blog-page">
                <h2 class="section-title">مقالات و اخبار</h2>
                
                <div class="blog-grid">
                    <div class="blog-card">
                        <div style="width: 100%; height: 250px; background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-cubes" style="font-size: 4rem;"></i>
                        </div>
                        <div class="blog-content">
                            <h3 class="blog-title">انواع قالب فلزی بتن و کاربردهای آنها</h3>
                            <div class="blog-date">۱۴۰۲/۱۲/۱۵</div>
                            <p class="blog-excerpt">
                                قالب فلزی بتن به عنوان یکی از پرکاربردترین سیستم‌های قالب‌بندی در صنعت ساختمان شناخته می‌شود. در این مقاله با انواع مختلف قالب فلزی و کاربردهای هر یک آشنا می‌شویم.
                            </p>
                            <a href="#" class="read-more">ادامه مطلب</a>
                        </div>
                    </div>
                    
                    <div class="blog-card">
                        <div style="width: 100%; height: 250px; background: linear-gradient(135deg, #047857 0%, #10b981 100%); display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-building" style="font-size: 4rem;"></i>
                        </div>
                        <div class="blog-content">
                            <h3 class="blog-title">نکات کلیدی در انتخاب قالب مناسب برای پروژه</h3>
                            <div class="blog-date">۱۴۰۲/۱۲/۱۰</div>
                            <p class="blog-excerpt">
                                انتخاب قالب مناسب برای پروژه ساختمانی می‌تواند تأثیر زیادی در کیفیت نهایی، سرعت اجرا و هزینه‌های پروژه داشته باشد. در این مقاله نکات مهم در انتخاب قالب را بررسی می‌کنیم.
                            </p>
                            <a href="#" class="read-more">ادامه مطلب</a>
                        </div>
                    </div>
                    
                    <div class="blog-card">
                        <div style="width: 100%; height: 250px; background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-industry" style="font-size: 4rem;"></i>
                        </div>
                        <div class="blog-content">
                            <h3 class="blog-title">مزایای استفاده از قالب مدولار در ساخت‌وساز</h3>
                            <div class="blog-date">۱۴۰۲/۱۲/۰۵</div>
                            <p class="blog-excerpt">
                                قالب مدولار به دلیل انعطاف‌پذیری و سرعت نصب بالا، تبدیل به یکی از محبوب‌ترین سیستم‌های قالب‌بندی شده است. در این مقاله مزایای این سیستم را بررسی می‌کنیم.
                            </p>
                            <a href="#" class="read-more">ادامه مطلب</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه امکانات -->
        <section id="features-page" class="page hidden">
            <div class="container" style="padding: 4rem 0;">
                <h2 class="section-title">امکانات پلتفرم</h2>
                <div class="features-grid">
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3>تایید هویت اعضا</h3>
                        <p>تمام اعضا پس از بررسی مدارک تایید می‌شوند تا از صحت و اعتبار آنها اطمینان حاصل شود.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3>دسترسی به بازار گسترده</h3>
                        <p>فروشندگان به درخواست‌های واقعی در سراسر کشور دسترسی دارند.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h3>سیستم امتیازدهی</h3>
                        <p>سیستم رتبه‌بندی و نظرات برای افزایش اعتماد بین کاربران.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-images"></i>
                        </div>
                        <h3>آپلود عکس</h3>
                        <p>امکان آپلود و مشاهده عکس برای هر دو طرف خریدار و فروشنده</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه نحوه کار -->
        <section id="how-it-works-page" class="page hidden">
            <div class="container" style="padding: 4rem 0;">
                <h2 class="section-title">چگونه از پلتفرم استفاده کنیم؟</h2>
                <div style="max-width: 800px; margin: 0 auto;">
                    <div style="display: flex; align-items: center; margin-bottom: 2rem; padding: 1.5rem; background: white; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; color: #3b82f6; margin-left: 1rem;">۱</div>
                        <div>
                            <h3 style="color: #1e3a8a; margin-bottom: 0.5rem;">ثبت‌نام و تأیید حساب</h3>
                            <p>ابتدا در پلتفرم ثبت‌نام کنید و حساب کاربری خود را با بارگذاری مدارک تأیید کنید.</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; align-items: center; margin-bottom: 2rem; padding: 1.5rem; background: white; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; color: #3b82f6; margin-left: 1rem;">۲</div>
                        <div>
                            <h3 style="color: #1e3a8a; margin-bottom: 0.5rem;">ایجاد یا مشاهده درخواست‌ها</h3>
                            <p>خریداران می‌توانند درخواست خود را با جزئیات و عکس ایجاد کنند. فروشندگان می‌توانند درخواست‌های موجود را مشاهده کنند.</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; align-items: center; margin-bottom: 2rem; padding: 1.5rem; background: white; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; color: #3b82f6; margin-left: 1rem;">۳</div>
                        <div>
                            <h3 style="color: #1e3a8a; margin-bottom: 0.5rem;">ارسال و دریافت پیشنهاد</h3>
                            <p>فروشندگان برای درخواست‌ها پیشنهاد قیمت ارسال می‌کنند. خریداران می‌توانند پیشنهادها را مقایسه کنند.</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; align-items: center; padding: 1.5rem; background: white; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; color: #3b82f6; margin-left: 1rem;">۴</div>
                        <div>
                            <h3 style="color: #1e3a8a; margin-bottom: 0.5rem;">انتخاب و تکمیل معامله</h3>
                            <p>خریدار بهترین پیشنهاد را انتخاب می‌کند و طرفین برای تکمیل معامله با یکدیگر ارتباط برقرار می‌کنند.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه داشبورد فروشنده قالب -->
        <section id="seller-formwork-dashboard-page" class="page hidden">
            <div class="container dashboard">
                <div class="dashboard-header">
                    <div class="user-info">
                        <div class="user-avatar" id="seller-formwork-avatar">?</div>
                        <div>
                            <h2 id="seller-formwork-name">فروشنده قالب عزیز</h2>
                            <p id="seller-formwork-type">حساب فروشنده قالب</p>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid" id="seller-formwork-stats">
                    <!-- آمار فروشنده قالب به صورت دینامیک بارگذاری می‌شود -->
                </div>
                
                <div class="dashboard-actions">
                    <button class="btn btn-secondary" onclick="loadFormworkSellerRequests()">
                        <i class="fas fa-list"></i> درخواست‌های باز قالب
                    </button>
                    <button class="btn btn-secondary" onclick="loadFormworkSellerBids()">
                        <i class="fas fa-money-bill-wave"></i> پیشنهادهای من (قالب)
                    </button>
                    <button class="btn btn-secondary" onclick="loadFormworkSellerTransactions()">
                        <i class="fas fa-exchange-alt"></i> تراکنش‌های من (قالب)
                    </button>
                </div>
                
                <div id="seller-formwork-dashboard-content">
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">لطفاً یک گزینه از بالا انتخاب کنید.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه داشبورد فروشنده سوله -->
        <section id="seller-shed-dashboard-page" class="page hidden">
            <div class="container dashboard">
                <div class="dashboard-header">
                    <div class="user-info">
                        <div class="user-avatar" id="seller-shed-avatar">?</div>
                        <div>
                            <h2 id="seller-shed-name">فروشنده سوله عزیز</h2>
                            <p id="seller-shed-type">حساب فروشنده سوله</p>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid" id="seller-shed-stats">
                    <!-- آمار فروشنده سوله به صورت دینامیک بارگذاری می‌شود -->
                </div>
                
                <div class="dashboard-actions">
                    <button class="btn btn-secondary" onclick="loadShedSellerRequests()">
                        <i class="fas fa-list"></i> درخواست‌های باز سوله
                    </button>
                    <button class="btn btn-secondary" onclick="loadShedSellerBids()">
                        <i class="fas fa-money-bill-wave"></i> پیشنهادهای من (سوله)
                    </button>
                    <button class="btn btn-secondary" onclick="loadShedSellerTransactions()">
                        <i class="fas fa-exchange-alt"></i> تراکنش‌های من (سوله)
                    </button>
                </div>
                
                <div id="seller-shed-dashboard-content">
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">لطفاً یک گزینه از بالا انتخاب کنید.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- صفحه بازاریابی -->
        <section id="marketing-page" class="page hidden">
            <div class="marketing-hero">
                <div class="container">
                    <h1>انقلابی در صنعت قالب‌های فلزی بتن و سوله</h1>
                    <p>اولین پلتفرم تخصصی که خریداران و فروشندگان قالب فلزی بتن و سوله را به صورت مستقیم و امن به هم متصل می‌کند</p>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" style="padding: 15px 40px; font-size: 1.2rem;" onclick="showPage('register')">
                            <i class="fas fa-user-tie"></i> شروع کنید به عنوان خریدار
                        </button>
                        <button class="btn btn-success" style="padding: 15px 40px; font-size: 1.2rem;" onclick="showPage('register')">
                            <i class="fas fa-industry"></i> شروع کنید به عنوان فروشنده
                        </button>
                    </div>
                </div>
            </div>

            <div class="benefits-section">
                <div class="container">
                    <h2 class="section-title">مزایای ویژه برای خریداران</h2>
                    <div class="benefits-grid">
                        <div class="benefit-card">
                            <div class="benefit-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <h3>کاهش ۳۰٪ هزینه‌ها</h3>
                            <p>با حذف واسطه‌ها و دلالان، قیمت نهایی قالب‌ها به طور متوسط ۳۰٪ کاهش می‌یابد. ارتباط مستقیم با تولیدکننده اصلی باعث حذف هزینه‌های اضافی می‌شود.</p>
                            <ul class="benefit-list">
                                <li><i class="fas fa-check"></i> قیمت‌گذاری شفاف</li>
                                <li><i class="fas fa-check"></i> امکان چانه‌زنی مستقیم</li>
                                <li><i class="fas fa-check"></i> مقایسه چندین پیشنهاد</li>
                            </ul>
                        </div>
                        
                        <div class="benefit-card">
                            <div class="benefit-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <h3>صرفه‌جویی در زمان</h3>
                            <p>دریافت پیشنهاد از چندین فروشنده معتبر در کمتر از ۲۴ ساعت. دیگر نیازی به جستجو و تماس با ده‌ها فروشنده نیست.</p>
                            <ul class="benefit-list">
                                <li><i class="fas fa-check"></i> درخواست سریع و آسان</li>
                                <li><i class="fas fa-check"></i> پاسخگویی سریع فروشندگان</li>
                                <li><i class="fas fa-check"></i> مدیریت متمرکز پیشنهادها</li>
                            </ul>
                        </div>
                        
                        <div class="benefit-card">
                            <div class="benefit-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3>امنیت و اطمینان</h3>
                            <p>تمام فروشندگان از نظر هویتی و سابقه کاری بررسی می‌شوند. سیستم امتیازدهی و نظرات شفافیت کامل ایجاد می‌کند.</p>
                            <ul class="benefit-list">
                                <li><i class="fas fa-check"></i> تایید هویت فروشندگان</li>
                                <li><i class="fas fa-check"></i> نظرات واقعی خریداران</li>
                                <li><i class="fas fa-check"></i> تضمین کیفیت محصول</li>
                            </ul>
                        </div>
                    </div>
                    
                    <h2 class="section-title" style="margin-top: 5rem;">مزایای ویژه برای فروشندگان</h2>
                    <div class="benefits-grid">
                        <div class="benefit-card">
                            <div class="benefit-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3>دسترسی به بازار گسترده</h3>
                            <p>دریافت درخواست‌های واقعی از سراسر کشور. دیگر نیازی به هزینه‌های بازاریابی سنتی و پیدا کردن مشتری نیست.</p>
                            <ul class="benefit-list">
                                <li><i class="fas fa-check"></i> درخواست‌های تأییدشده</li>
                                <li><i class="fas fa-check"></i> مشتریان واقعی و متعهد</li>
                                <li><i class="fas fa-check"></i> بازار سراسری</li>
                            </ul>
                        </div>
                        
                        <div class="benefit-card">
                            <div class="benefit-icon">
                                <i class="fas fa-user-secret"></i>
                            </div>
                            <h3>حریم خصوصی محفوظ</h3>
                            <p>اطلاعات شما تا زمان انتخاب پیشنهاد محرمانه می‌ماند. از رقابت ناسالم و کپی‌برداری توسط رقبا در امان باشید.</p>
                            <ul class="benefit-list">
                                <li><i class="fas fa-check"></i> نام و مشخصات مخفی</li>
                                <li><i class="fas fa-check"></i> قیمت‌گذاری رقابتی</li>
                                <li><i class="fas fa-check"></i> حفاظت از اطلاعات</li>
                            </ul>
                        </div>
                        
                        <div class="benefit-card">
                            <div class="benefit-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <h3>ساختن برند معتبر</h3>
                            <p>با هر معامله موفق، امتیاز و اعتبار شما افزایش می‌یابد. برند شخصی خود را در صنعت قالب‌سازی بسازید.</p>
                            <ul class="benefit-list">
                                <li><i class="fas fa-check"></i> سیستم امتیازدهی</li>
                                <li><i class="fas fa-check"></i> نظرات مثبت خریداران</li>
                                <li><i class="fas fa-check"></i> افزایش اعتماد مشتریان</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="testimonials">
                <div class="container">
                    <h2 class="section-title">نظرات کاربران ما</h2>
                    <div class="testimonial-grid">
                        <div class="testimonial-card">
                            <div class="testimonial-text">
                                "به عنوان یک پیمانکار، همیشه مشکل پیدا کردن قالب با کیفیت و قیمت مناسب را داشتم. B2BSteel این مشکل را برای همیشه حل کرد. قیمت‌ها واقعاً ۳۰٪ کمتر از بازار است."
                            </div>
                            <div class="testimonial-author">
                                <div class="testimonial-avatar">م.ح</div>
                                <div class="testimonial-info">
                                    <h4>مهندس حسینی</h4>
                                    <p>پیمانکار ساختمانی - تهران</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="testimonial-card">
                            <div class="testimonial-text">
                                "کارخانه ما سال‌ها برای بازاریابی مشکل داشت. الان در کمتر از ۳ ماه، ۱۵ پروژه بزرگ از طریق این پلتفرم دریافت کردیم. واقعاً انقلابی در فروش ما ایجاد شده است."
                            </div>
                            <div class="testimonial-author">
                                <div class="testimonial-avatar">ر.ا</div>
                                <div class="testimonial-info">
                                    <h4>رضا احمدی</h4>
                                    <p>مدیر فروش کارخانه قالب‌سازی - اصفهان</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="testimonial-card">
                            <div class="testimonial-text">
                                "شفافیت قیمت‌ها فوق‌العاده است. می‌توانم پیشنهاد ۵ فروشنده مختلف را ببینم و بهترین را انتخاب کنم. سیستم امتیازدهی هم کمک بزرگی برای انتخاب فروشنده معتبر است."
                            </div>
                            <div class="testimonial-author">
                                <div class="testimonial-avatar">س.ن</div>
                                <div class="testimonial-info">
                                    <h4>سارا نوروزی</h4>
                                    <p>مدیر پروژه - مشهد</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="cta-section">
                <div class="container">
                    <h2>همین امروز شروع کنید</h2>
                    <p>ثبت‌نام رایگان است و در کمتر از ۲ دقیقه انجام می‌شود. به جامعه متخصصان صنعت قالب‌سازی بتن و سوله بپیوندید.</p>
                    <div class="hero-buttons">
                        <button class="btn btn-primary" style="padding: 15px 40px; font-size: 1.2rem; background: white; color: #047857; border: 2px solid white;" onclick="showPage('register')">
                            <i class="fas fa-user-tie"></i> ثبت‌نام خریدار
                        </button>
                        <button class="btn btn-success" style="padding: 15px 40px; font-size: 1.2rem; background: white; color: #047857; border: 2px solid white;" onclick="showPage('register')">
                            <i class="fas fa-industry"></i> ثبت‌نام فروشنده
                        </button>
                    </div>
                    <p style="margin-top: 2rem; font-size: 1rem; opacity: 0.9;">بیش از ۱۰۰۰ پروژه موفق از طریق پلتفرم ما انجام شده است</p>
                </div>
            </div>
        </section>

    </main>

    <!-- ==================== مودال‌های سیستم قالب بتن ==================== -->
    
    <!-- مودال ایجاد درخواست جدید -->
    <div id="new-request-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ایجاد درخواست جدید</h3>
                <button class="close-modal" onclick="closeModal('new-request-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="new-request-form">
                    <div class="form-group">
                        <label for="request-title">عنوان درخواست</label>
                        <input type="text" id="request-title" class="form-control" required placeholder="مثال: قالب مدولار برای پروژه مسکونی 10 طبقه">
                        <div class="form-help">نام پروژه یا عنوان درخواست خود را وارد کنید</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="request-description">توضیحات</label>
                        <textarea id="request-description" class="form-control" rows="3" required placeholder="جزئیات پروژه، ابعاد مورد نیاز، مشخصات فنی و ..."></textarea>
                    </div>
                    
                    <!-- بخش اقلام درخواستی -->
                    <div class="form-group">
                        <label>انتخاب اقلام درخواستی</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-modular" name="request-items" value="مدولار">
                                <label for="item-modular">قالب مدولار</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-special" name="request-items" value="خاص">
                                <label for="item-special">قالب خاص (ویژه)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-tunnelform" name="request-items" value="تونلفرم">
                                <label for="item-tunnelform">تونلفرم</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-scaffolding" name="request-items" value="داربست">
                                <label for="item-scaffolding">داربست</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-caplock" name="request-items" value="کاپلاک">
                                <label for="item-caplock">کاپلاک</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-accessories" name="request-items" value="ملحقات">
                                <label for="item-accessories">ملحقات</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-round-column" name="request-items" value="ستونی گرد">
                                <label for="item-round-column">ستونی گرد</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-sliding" name="request-items" value="لغزنده">
                                <label for="item-sliding">لغزنده</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-climbing" name="request-items" value="بالارونده">
                                <label for="item-climbing">بالارونده</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="item-panel" name="request-items" value="پنلی">
                                <label for="item-panel">پنلی</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="request-material">جنس قالب</label>
                        <select id="request-material" class="form-control" required>
                            <option value="">-- انتخاب کنید --</option>
                            <option value="ورق رویه فولاد مبارکه">ورق رویه فولاد مبارکه</option>
                            <option value="ورق رویه و تسمه های دور فولاد مبارکه">ورق رویه و تسمه های دور فولاد مبارکه</option>
                            <option value="سایر">سایر</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="request-project-location">محل اجرای پروژه</label>
                        <input type="text" id="request-project-location" class="form-control" placeholder="مثال: تهران" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="request-deadline">مهلت ارسال پیشنهاد</label>
                        <div class="date-selector">
                            <select id="request-deadline-year" class="form-control" required>
                                <option value="">سال</option>
                                <option value="1404">۱۴۰۴</option>
                                <option value="1405">۱۴۰۵</option>
                                <option value="1406">۱۴۰۶</option>
                                <option value="1407">۱۴۰۷</option>
                                <option value="1408">۱۴۰۸</option>
                                <option value="1409">۱۴۰۹</option>
                                <option value="1410">۱۴۱۰</option>
                            </select>
                            <select id="request-deadline-month" class="form-control" required>
                                <option value="">ماه</option>
                                <option value="01">فروردین</option>
                                <option value="02">اردیبهشت</option>
                                <option value="03">خرداد</option>
                                <option value="04">تیر</option>
                                <option value="05">مرداد</option>
                                <option value="06">شهریور</option>
                                <option value="07">مهر</option>
                                <option value="08">آبان</option>
                                <option value="09">آذر</option>
                                <option value="10">دی</option>
                                <option value="11">بهمن</option>
                                <option value="12">اسفند</option>
                            </select>
                            <select id="request-deadline-day" class="form-control" required>
                                <option value="">روز</option>
                                <!-- روزها به صورت داینامیک پر می‌شوند -->
                            </select>
                        </div>
                        <div class="form-help">تاریخ مهلت ارسال پیشنهاد را انتخاب کنید</div>
                    </div>
                    
                    <!-- آپلود عکس برای خریدار -->
                    <div class="form-group">
                        <label>آپلود عکس نمونه (اختیاری)</label>
                        <div class="image-upload-container" onclick="document.getElementById('request-image-upload').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>برای آپلود عکس کلیک کنید یا فایل را اینجا رها کنید</p>
                            <input type="file" id="request-image-upload" accept="image/*" style="display: none;" onchange="previewRequestImage(event)">
                            <img id="request-image-preview" class="image-preview" alt="پیش‌نمایش عکس">
                        </div>
                        <div id="uploaded-images"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('new-request-modal')">انصراف</button>
                <button class="btn btn-primary" onclick="submitNewRequest()">ثبت درخواست</button>
            </div>
        </div>
    </div>

    <!-- مودال ارسال پیشنهاد قالب -->
    <div id="submit-bid-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ارسال پیشنهاد قیمت</h3>
                <button class="close-modal" onclick="closeModal('submit-bid-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: #eff6ff; padding: 10px 15px; border-radius: 6px; margin-bottom: 20px; border-right: 4px solid #3b82f6;">
                    <strong>پروژه:</strong> <span id="bid-project-title">در حال بارگذاری...</span>
                </div>
                
                <form id="submit-bid-form">
                    <input type="hidden" id="bid-request-id">
                    
                    <div class="form-group">
                        <label for="bid-base-price">قیمت کل پیشنهادی بدون ارزش افزوده (ریال)</label>
                        <input type="text" id="bid-base-price" class="form-control" required 
                               oninput="formatPriceInput(this)" 
                               placeholder="مثال: ۱۰,۰۰۰,۰۰۰,۰۰۰">
                        <div class="form-help">قیمت پایه محصول بدون احتساب ارزش افزوده و بارگیری</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-vat-percentage">درصد ارزش افزوده</label>
                        <select id="bid-vat-percentage" class="form-control" required onchange="calculateTotalPrice()">
                            <option value="10">10%</option>
                            <option value="11">11%</option>
                            <option value="12">12%</option>
                            <option value="13">13%</option>
                            <option value="14">14%</option>
                            <option value="15" selected>15%</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-loading-percentage">درصد بارگیری</label>
                        <select id="bid-loading-percentage" class="form-control" required onchange="calculateTotalPrice()">
                            <option value="1">1%</option>
                            <option value="2" selected>2%</option>
                            <option value="3">3%</option>
                            <option value="4">4%</option>
                            <option value="5">5%</option>
                        </select>
                    </div>
                    
                    <div class="price-breakdown">
                        <div class="price-row">
                            <span>قیمت پایه:</span>
                            <span id="display-base-price">0 ریال</span>
                        </div>
                        <div class="price-row">
                            <span>ارزش افزوده (<span id="display-vat-percentage">15</span>%):</span>
                            <span id="display-vat-amount">0 ریال</span>
                        </div>
                        <div class="price-row">
                            <span>بارگیری (<span id="display-loading-percentage">2</span>%):</span>
                            <span id="display-loading-amount">0 ریال</span>
                        </div>
                        <div class="price-row total">
                            <span>قیمت کل نهایی:</span>
                            <span id="display-total-price">0 ریال</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-delivery">زمان تحویل (روز)</label>
                        <input type="number" id="bid-delivery" class="form-control" value="30" required min="1">
                        <div class="form-help">تعداد روز کاری تا تحویل محصول</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-warranty">گارانتی (ماه)</label>
                        <input type="number" id="bid-warranty" class="form-control" value="12" required min="0">
                        <div class="form-help">مدت گارانتی محصول بر اساس ماه</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-notes">توضیحات (اختیاری)</label>
                        <textarea id="bid-notes" class="form-control" rows="3" placeholder="توضیحات اضافی درباره محصول، خدمات پس از فروش، شرایط پرداخت و ..."></textarea>
                    </div>
                    
                    <!-- آپلود عکس برای فروشنده -->
                    <div class="form-group">
                        <label>آپلود عکس محصول یا نمونه کار (اختیاری)</label>
                        <div class="image-upload-container" onclick="document.getElementById('bid-image-upload').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>برای آپلود عکس کلیک کنید یا فایل را اینجا رها کنید</p>
                            <input type="file" id="bid-image-upload" accept="image/*" style="display: none;" onchange="previewBidImage(event)">
                            <img id="bid-image-preview" class="image-preview" alt="پیش‌نمایش عکس">
                        </div>
                        <div id="bid-uploaded-images"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('submit-bid-modal')">انصراف</button>
                <button class="btn btn-primary" onclick="submitBid()">ارسال پیشنهاد</button>
            </div>
        </div>
    </div>

    <!-- مودال ارسال پیشنهاد سوله (اصلاح شده با قیمت بر اساس کیلوگرم) -->
    <div id="submit-shed-bid-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ارسال پیشنهاد قیمت برای سوله</h3>
                <button class="close-modal" onclick="closeModal('submit-shed-bid-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: #eff6ff; padding: 10px 15px; border-radius: 6px; margin-bottom: 20px; border-right: 4px solid #3b82f6;">
                    <strong>پروژه سوله:</strong> <span id="shed-bid-project-title">در حال بارگذاری...</span>
                </div>
                
                <!-- نمایش مسئولیت‌های خریدار -->
                <div id="shed-bid-buyer-responsibilities" style="background: #fef3c7; padding: 10px 15px; border-radius: 6px; margin-bottom: 20px; border-right: 4px solid #f59e0b;">
                    <strong>مسئولیت‌های خریدار:</strong> <span id="shed-bid-responsibilities-list">در حال بارگذاری...</span>
                </div>
                
                <form id="submit-shed-bid-form">
                    <input type="hidden" id="shed-bid-request-id">
                    
                    <div class="form-group">
                        <label for="shed-bid-price-per-kg">قیمت هر کیلوگرم (ریال)</label>
                        <input type="text" id="shed-bid-price-per-kg" class="form-control" required 
                               oninput="calculateShedTotalPrice()" 
                               placeholder="مثال: ۵۰,۰۰۰">
                        <div class="form-help">قیمت ارائه شده شامل همه مراحل تهیه متریال و پیچ و مهره، تهیه کلیه نقشه ها ، ساخت کامل با مصالح مورد نیاز، رنگ، حمل و تا اتمام کامل عملیات نصب است ( طبق موارد درخواست مشتری ) به جز مواردی که کارفرما در استعلام خود به عهده گرفته است.</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="shed-bid-estimated-weight">وزن حدودی سوله (کیلوگرم) <small>(با تقریب ۳٪)</small></label>
                        <input type="text" id="shed-bid-estimated-weight" class="form-control" required 
                               oninput="calculateShedTotalPrice()" 
                               placeholder="مثال: ۱۰,۰۰۰">
                        <div class="form-help">وزن تقریبی سوله با تقریب ۳٪</div>
                    </div>
                    
                    <div class="price-breakdown">
                        <div class="price-row">
                            <span>قیمت هر کیلوگرم:</span>
                            <span id="display-price-per-kg">0 ریال</span>
                        </div>
                        <div class="price-row">
                            <span>وزن حدودی (با تقریب ۳٪):</span>
                            <span id="display-estimated-weight">0 کیلوگرم</span>
                        </div>
                        <div class="price-row total">
                            <span>قیمت کل نهایی:</span>
                            <span id="display-shed-total-price">0 ریال</span>
                        </div>
                    </div>

                    <!-- متن زیر قیمت کل نهایی -->
                    <div style="margin-top: 15px; padding: 10px; background-color: #f8fafc; border-radius: 6px; border: 1px solid #e5e7eb; font-size: 0.9rem; color: #6b7280;">
                        <p style="margin: 0;">قیمت ارائه شده بدون ارزش افزوده می‌باشد و ارزش افزوده در فاکتور نهایی درج خواهد گردید. مابقی تکالیف قانونی، مالیاتی و بیمه به عهده و هزینه فروشنده می‌باشد.</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="shed-bid-delivery">زمان تحویل (روز)</label>
                        <input type="number" id="shed-bid-delivery" class="form-control" value="60" required min="30">
                        <div class="form-help">تعداد روز کاری تا تحویل و نصب کامل سوله</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="shed-bid-warranty">گارانتی (ماه)</label>
                        <input type="number" id="shed-bid-warranty" class="form-control" value="6" required min="0">
                        <div class="form-help">مدت گارانتی سوله بر اساس ماه</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="shed-bid-notes">توضیحات (اختیاری)</label>
                        <textarea id="shed-bid-notes" class="form-control" rows="3" placeholder="جزئیات ساخت، متریال مورد استفاده، خدمات پس از فروش و ..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('submit-shed-bid-modal')">انصراف</button>
                <button class="btn btn-primary" onclick="submitShedBid()">ارسال پیشنهاد</button>
            </div>
        </div>
    </div>

    <!-- مودال مشاهده پیشنهادها -->
    <div id="view-bids-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>پیشنهادهای دریافتی</h3>
                <button class="close-modal" onclick="closeModal('view-bids-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="bids-list">
                    <!-- لیست پیشنهادها اینجا نمایش داده می‌شود -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('view-bids-modal')">بستن</button>
            </div>
        </div>
    </div>

    <!-- مودال مشاهده پیشنهادهای سوله -->
    <div id="view-shed-bids-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>پیشنهادهای دریافتی برای سوله</h3>
                <button class="close-modal" onclick="closeModal('view-shed-bids-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="shed-bids-list">
                    <!-- لیست پیشنهادهای سوله اینجا نمایش داده می‌شود -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('view-shed-bids-modal')">بستن</button>
            </div>
        </div>
    </div>

    <!-- مودال امتیازدهی -->
    <div id="rating-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>امتیازدهی به فروشنده</h3>
                <button class="close-modal" onclick="closeModal('rating-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="rating-form">
                    <input type="hidden" id="rating-transaction-id">
                    
                    <div class="form-group">
                        <label>امتیاز به فروشنده (۱ تا ۵ ستاره)</label>
                        <div class="rating-stars">
                            <i class="fas fa-star rating-star" data-rating="1" onclick="setRating(1)"></i>
                            <i class="fas fa-star rating-star" data-rating="2" onclick="setRating(2)"></i>
                            <i class="fas fa-star rating-star" data-rating="3" onclick="setRating(3)"></i>
                            <i class="fas fa-star rating-star" data-rating="4" onclick="setRating(4)"></i>
                            <i class="fas fa-star rating-star" data-rating="5" onclick="setRating(5)"></i>
                        </div>
                        <input type="hidden" id="rating-value" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="rating-comment">نظر شما درباره فروشنده (اختیاری)</label>
                        <textarea id="rating-comment" class="form-control" rows="3" placeholder="تجربه خود از همکاری با این فروشنده را بنویسید..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('rating-modal')">بعداً</button>
                <button class="btn btn-primary" onclick="submitRating()">ثبت امتیاز</button>
            </div>
        </div>
    </div>

    <!-- فوتر -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>B2BSteel</h3>
                    <p>اولین پلتفرم تخصصی ارتباط مستقیم بین خریداران و فروشندگان قالب‌های فلزی بتن و سوله در ایران</p>
                </div>
                
                <div class="footer-section">
                    <h3>لینک‌های سریع</h3>
                    <ul>
                        <li><a href="#" onclick="showPage('home')">خانه</a></li>
                        <li><a href="#" onclick="showPage('concrete-formwork')">قالب بتن</a></li>
                        <li><a href="#" onclick="showPage('shed')">سوله</a></li>
                        <li><a href="#" onclick="showPage('marketing')">چرا B2BSteel؟</a></li>
                        <li><a href="#" onclick="showPage('features')">امکانات</a></li>
                        <li><a href="#" onclick="showPage('how-it-works')">نحوه کار</a></li>
                        <li><a href="#" onclick="showPage('blog')">بلاگ</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>تماس با ما</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> ۰۲۱-۱۲۳۴۵۶۷۸</li>
                        <li><i class="fas fa-envelope"></i> info@betonghalabyab.ir</li>
                        <li><i class="fas fa-map-marker-alt"></i> تهران، خیابان ولیعصر</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>© ۱۴۰۲ کلیه حقوق برای پلتفرم B2BSteel محفوظ است.</p>
            </div>
        </div>
    </footer>

    <script>
        // ==================== سیستم ذخیره‌سازی ====================
        class Database {
            constructor() {
                this.users = JSON.parse(localStorage.getItem('beton_users')) || [];
                this.requests = JSON.parse(localStorage.getItem('beton_requests')) || [];
                this.bids = JSON.parse(localStorage.getItem('beton_bids')) || [];
                this.transactions = JSON.parse(localStorage.getItem('beton_transactions')) || [];
                this.shedRequests = JSON.parse(localStorage.getItem('shed_requests')) || [];
                this.shedBids = JSON.parse(localStorage.getItem('shed_bids')) || [];
                this.shedTransactions = JSON.parse(localStorage.getItem('shed_transactions')) || [];
                this.shedListings = JSON.parse(localStorage.getItem('shed_listings')) || [];
                this.images = JSON.parse(localStorage.getItem('beton_images')) || {};
                this.blogs = JSON.parse(localStorage.getItem('beton_blogs')) || [];
                this.ratings = JSON.parse(localStorage.getItem('beton_ratings')) || [];
                
                // ایجاد داده‌های نمونه اگر خالی باشد
                if (this.users.length === 0) {
                    this.createSampleData();
                }
                
                // ایجاد داده‌های نمونه برای سوله
                if (this.shedListings.length === 0) {
                    this.createSampleShedData();
                }
            }
            
            createSampleData() {
                console.log('ایجاد داده‌های نمونه سیستم قالب بتن...');
                
                // کاربر ادمین
                this.users = [
                    {
                        id: 1,
                        email: 'admin@example.com',
                        password: 'admin123',
                        userType: 'admin',
                        companyName: 'ادمین سیستم',
                        contactPerson: 'مدیر سیستم',
                        phone: '02111111111',
                        verificationStatus: 'verified',
                        rating: 5.0,
                        totalTransactions: 0,
                        isAdmin: true,
                        userLegalType: 'company',
                        position: 'مدیر سیستم',
                        totalPurchase: 0,
                        totalSales: 0,
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        email: 'buyer@example.com',
                        password: '123456',
                        userType: 'buyer',
                        companyName: 'ساختمان‌سازی پیشرو',
                        contactPerson: 'علی محمدی',
                        phone: '09121234567',
                        verificationStatus: 'verified',
                        rating: 4.5,
                        totalTransactions: 5,
                        isAdmin: false,
                        userLegalType: 'company',
                        position: 'مدیر بازرگانی',
                        totalPurchase: 5500000000,
                        totalSales: 0,
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        email: 'seller-formwork@example.com',
                        password: '123456',
                        userType: 'seller',
                        sellerType: 'formwork',
                        companyName: 'کارخانه قالب‌سازی فولادین',
                        contactPerson: 'رضا احمدی',
                        phone: '02187654321',
                        verificationStatus: 'verified',
                        rating: 4.7,
                        totalTransactions: 15,
                        isAdmin: false,
                        userLegalType: 'company',
                        position: 'مدیر فروش',
                        totalPurchase: 0,
                        totalSales: 32000000000,
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 4,
                        email: 'seller-shed@example.com',
                        password: '123456',
                        userType: 'seller',
                        sellerType: 'shed',
                        companyName: 'شرکت ساخت سوله سپهر',
                        contactPerson: 'محمد حسینی',
                        phone: '09131234567',
                        verificationStatus: 'verified',
                        rating: 4.8,
                        totalTransactions: 8,
                        isAdmin: false,
                        userLegalType: 'company',
                        position: 'مدیر فنی',
                        totalPurchase: 0,
                        totalSales: 18000000000,
                        createdAt: new Date().toISOString()
                    }
                ];
                
                // ایجاد درخواست‌های نمونه
                this.requests = [
                    {
                        id: 1,
                        title: 'قالب مدولار برای پروژه مسکونی ۱۰ طبقه',
                        description: 'نیاز به قالب مدولار برای ساخت پروژه مسکونی ۱۰ طبقه در منطقه الهیه تهران',
                        items: ['مدولار', 'دیوار'],
                        material: 'ورق رویه فولاد مبارکه',
                        projectLocation: 'تهران - الهیه',
                        deadline: '1404/03/15',
                        buyerId: 2,
                        status: 'open',
                        createdAt: new Date('2024-01-15').toISOString(),
                        images: []
                    },
                    {
                        id: 2,
                        title: 'قالب ستون برای پروژه تجاری',
                        description: 'قالب ستون با ابعاد ۴۰×۴۰ سانتیمتر برای پروژه تجاری در کرج',
                        items: ['ستونی گرد'],
                        material: 'ورق رویه و تسمه های دور فولاد مبارکه',
                        projectLocation: 'کرج',
                        deadline: '1404/02/30',
                        buyerId: 2,
                        status: 'in_progress',
                        createdAt: new Date('2024-01-10').toISOString(),
                        images: []
                    }
                ];
                
                // ایجاد درخواست‌های سوله نمونه (با داده‌های جدید)
                this.shedRequests = [
                    {
                        id: 1,
                        type: 'new',
                        dimensions: {
                            length: 100,
                            width: 30,
                            height: 6
                        },
                        hasDrawing: false,
                        usage: 'انبار صنعتی برای شرکت تولیدی',
                        location: 'تهران، شهرک صنعتی شریف',
                        needsCrane: true,
                        craneTonnage: 5,
                        foundation: 'no',
                        sandblast: 'no',
                        paintType: 'ضد زنگ',
                        otherPaintType: '',
                        paintThickness: 50,
                        buyerResponsibilities: ['steel'],
                        weight: null,
                        priceType: 'estimated',
                        buyerId: 2,
                        status: 'open',
                        createdAt: new Date('2024-02-01').toISOString()
                    }
                ];
                
                // ایجاد پیشنهادهای نمونه
                this.bids = [
                    {
                        id: 1,
                        requestId: 1,
                        sellerId: 3,
                        basePrice: 2500000000,
                        vatPercentage: 15,
                        loadingPercentage: 2,
                        deliveryDays: 25,
                        warrantyMonths: 12,
                        notes: 'قیمت شامل حمل و نصب اولیه می‌باشد',
                        status: 'submitted',
                        createdAt: new Date('2024-01-16').toISOString(),
                        images: []
                    }
                ];
                
                // ایجاد پیشنهادهای سوله نمونه (با داده‌های جدید)
                this.shedBids = [
                    {
                        id: 1,
                        requestId: 1,
                        sellerId: 4,
                        pricePerKg: 50000,
                        estimatedWeight: 10000,
                        totalPrice: 500000000,
                        deliveryDays: 60,
                        warrantyMonths: 6,
                        notes: 'قیمت شامل طراحی، ساخت و نصب کامل می‌باشد',
                        status: 'submitted',
                        createdAt: new Date('2024-02-02').toISOString()
                    }
                ];
                
                this.saveAll();
                console.log('داده‌های نمونه سیستم با موفقیت ایجاد شدند.');
            }
            
            createSampleShedData() {
                console.log('ایجاد داده‌های نمونه بخش سوله...');
                
                this.shedListings = [
                    {
                        id: 1,
                        title: 'سوله صنعتی 100x30 متر',
                        location: 'تهران، شهرک صنعتی شریف',
                        dimensions: '100x30x6 متر',
                        age: '5 سال',
                        condition: 'عالی',
                        price: '۲,۵۰۰,۰۰۰,۰۰۰ ریال',
                        features: ['جرثقیل سقفی 10 تن', 'فونداسیون سالم', 'دارای رنگ‌کاری', 'سیستم روشنایی'],
                        seller: 'شرکت فولادین',
                        phone: '۰۹۱۲۱۲۳۴۵۶۷',
                        description: 'سوله صنعتی در شرایط عالی، آماده جابجایی و نصب مجدد',
                        type: 'secondhand'
                    },
                    {
                        id: 2,
                        title: 'سوله انبار 25x20 متر',
                        location: 'البرز، شهرک صنعتی هفت تیر',
                        dimensions: '25x20x6 متر',
                        age: '3 سال',
                        condition: 'نو',
                        price: '۱,۸۰۰,۰۰۰,۰۰۰ ریال',
                        features: ['عایق حرارتی', 'درب ریلی', 'سیستم اعلام حریق'],
                        seller: 'کارخانه پارس',
                        phone: '۰۲۱۷۷۶۵۴۳۲۱',
                        description: 'سوله انبار با عایق حرارتی مناسب برای نگهداری مواد',
                        type: 'secondhand'
                    }
                ];
                
                this.saveAll();
                console.log('داده‌های نمونه بخش سوله با موفقیت ایجاد شدند.');
            }
            
            saveAll() {
                localStorage.setItem('beton_users', JSON.stringify(this.users));
                localStorage.setItem('beton_requests', JSON.stringify(this.requests));
                localStorage.setItem('beton_bids', JSON.stringify(this.bids));
                localStorage.setItem('beton_transactions', JSON.stringify(this.transactions));
                localStorage.setItem('beton_images', JSON.stringify(this.images));
                localStorage.setItem('beton_blogs', JSON.stringify(this.blogs));
                localStorage.setItem('beton_ratings', JSON.stringify(this.ratings));
                localStorage.setItem('shed_requests', JSON.stringify(this.shedRequests));
                localStorage.setItem('shed_bids', JSON.stringify(this.shedBids));
                localStorage.setItem('shed_transactions', JSON.stringify(this.shedTransactions));
                localStorage.setItem('shed_listings', JSON.stringify(this.shedListings));
            }
            
            // متدهای کمکی
            getUserById(id) {
                return this.users.find(u => u.id === id);
            }
            
            getRequestsByBuyer(buyerId) {
                return this.requests.filter(r => r.buyerId === buyerId);
            }
            
            getShedRequestsByBuyer(buyerId) {
                return this.shedRequests.filter(r => r.buyerId === buyerId);
            }
            
            getRequestsBySeller(sellerId) {
                const sellerBids = this.bids.filter(b => b.sellerId === sellerId);
                return this.requests.filter(r => 
                    sellerBids.some(b => b.requestId === r.id)
                );
            }
            
            getShedRequestsBySeller(sellerId) {
                const sellerBids = this.shedBids.filter(b => b.sellerId === sellerId);
                return this.shedRequests.filter(r => 
                    sellerBids.some(b => b.requestId === r.id)
                );
            }
            
            getBidsByRequest(requestId) {
                return this.bids.filter(b => b.requestId === requestId);
            }
            
            getShedBidsByRequest(requestId) {
                return this.shedBids.filter(b => b.requestId === requestId);
            }
            
            getBidsBySeller(sellerId) {
                return this.bids.filter(b => b.sellerId === sellerId);
            }
            
            getShedBidsBySeller(sellerId) {
                return this.shedBids.filter(b => b.sellerId === sellerId);
            }
            
            getOpenRequests() {
                return this.requests.filter(r => r.status === 'open');
            }
            
            getOpenShedRequests() {
                return this.shedRequests.filter(r => r.status === 'open');
            }
            
            getShedListings() {
                return this.shedListings;
            }
            
            addShedRequest(request) {
                this.shedRequests.push(request);
                this.saveAll();
            }
            
            addShedBid(bid) {
                this.shedBids.push(bid);
                this.saveAll();
            }
            
            getFormworkSellers() {
                return this.users.filter(u => u.userType === 'seller' && u.sellerType === 'formwork');
            }
            
            getShedSellers() {
                return this.users.filter(u => u.userType === 'seller' && u.sellerType === 'shed');
            }
        }

        // ==================== مدیریت وضعیت برنامه ====================
        const db = new Database();
        let currentUser = JSON.parse(localStorage.getItem('current_user')) || null;
        let selectedUserType = 'buyer';
        let selectedUserLegalType = 'company';
        let selectedSellerType = 'formwork';
        let currentRequestImages = [];
        let currentBidImages = [];
        let currentRating = 0;

        // ==================== تبدیل اعداد فارسی کامل ====================
        function toPersianNumbers(num) {
            const persianDigits = ['۰', '۱', '۲', '۳', '۴', '۵', '۶', '۷', '۸', '۹'];
            return num.toString().replace(/\d/g, x => persianDigits[x]);
        }

        function toEnglishNumbers(str) {
            const persianDigits = ['۰', '۱', '۲', '۳', '۴', '۵', '۶', '۷', '۸', '۹'];
            const englishDigits = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
            
            let result = str;
            for (let i = 0; i < 10; i++) {
                result = result.replace(new RegExp(persianDigits[i], 'g'), englishDigits[i]);
            }
            return result;
        }

        // ==================== تابع جدید و ساده‌تر برای ورود قیمت ====================
        function formatPriceInput(input) {
            // ذخیره موقعیت کرسر
            const start = input.selectionStart;
            
            // مقدار فعلی را بگیر
            let value = input.value;
            
            // اگر خالی است، برگرد
            if (value === '') {
                calculateTotalPrice();
                return;
            }
            
            // اعداد فارسی را به انگلیسی تبدیل کن
            value = toEnglishNumbers(value);
            
            // فقط اعداد را نگه دار
            value = value.replace(/[^\d]/g, '');
            
            // اگر بعد از حذف غیراعداد، خالی شد
            if (value === '') {
                input.value = '';
                calculateTotalPrice();
                return;
            }
            
            // به عدد تبدیل کن
            const num = parseInt(value);
            
            // اگر عدد معتبر نیست
            if (isNaN(num)) {
                input.value = '';
                calculateTotalPrice();
                return;
            }
            
            // با جداکننده هزارگان فارسی فرمت کن
            const formatted = num.toLocaleString('fa-IR');
            
            // مقدار جدید را تنظیم کن
            input.value = formatted;
            
            // سعی کن موقعیت کرسر را حفظ کنی
            try {
                // کرسر را به انتها ببر (راحت‌ترین راه)
                input.setSelectionRange(formatted.length, formatted.length);
            } catch (e) {
                // در صورت خطا، کاری نکن
            }
            
            // قیمت کل را محاسبه کن
            calculateTotalPrice();
        }

        // تابع ساده برای تبدیل عدد فرمت شده به مقدار عددی
        function parseFormattedNumber(formattedValue) {
            if (!formattedValue || formattedValue === '') return 0;
            
            // اعداد فارسی را به انگلیسی تبدیل کن
            let value = toEnglishNumbers(formattedValue);
            
            // همه غیراعداد را حذف کن
            value = value.replace(/[^\d]/g, '');
            
            // به عدد تبدیل کن
            const num = parseInt(value);
            
            // اگر عدد معتبر است برگردان، در غیر این صورت صفر
            return isNaN(num) ? 0 : num;
        }

        function formatNumberFarsiDisplay(number) {
            return number.toLocaleString('fa-IR');
        }

        // ==================== توابع کمکی ====================
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('fa-IR');
        }

        function getStatusBadge(status) {
            switch(status) {
                case 'open': return { class: 'badge-open', text: 'باز' };
                case 'in_progress': return { class: 'badge-in-progress', text: 'در حال بررسی' };
                case 'closed': return { class: 'badge-closed', text: 'بسته' };
                case 'expired': return { class: 'badge-expired', text: 'منقضی شده' };
                case 'selected': return { class: 'badge-selected', text: 'انتخاب شده' };
                default: return { class: 'badge-closed', text: 'بسته' };
            }
        }

        // ==================== محاسبه قیمت کل ====================
        function calculateTotalPrice() {
            const basePriceInput = document.getElementById('bid-base-price');
            const basePrice = parseFormattedNumber(basePriceInput.value);
            const vatPercentage = parseFloat(document.getElementById('bid-vat-percentage').value);
            const loadingPercentage = parseFloat(document.getElementById('bid-loading-percentage').value);
            
            const vatAmount = (basePrice * vatPercentage) / 100;
            const loadingAmount = (basePrice * loadingPercentage) / 100;
            const totalPrice = basePrice + vatAmount + loadingAmount;
            
            document.getElementById('display-base-price').textContent = formatNumberFarsiDisplay(basePrice) + ' ریال';
            document.getElementById('display-vat-percentage').textContent = toPersianNumbers(vatPercentage);
            document.getElementById('display-vat-amount').textContent = formatNumberFarsiDisplay(vatAmount) + ' ریال';
            document.getElementById('display-loading-percentage').textContent = toPersianNumbers(loadingPercentage);
            document.getElementById('display-loading-amount').textContent = formatNumberFarsiDisplay(loadingAmount) + ' ریال';
            document.getElementById('display-total-price').textContent = formatNumberFarsiDisplay(totalPrice) + ' ریال';
            
            return {
                basePrice,
                vatAmount,
                loadingAmount,
                totalPrice
            };
        }

        // ==================== محاسبه قیمت کل سوله ====================
        function calculateShedTotalPrice() {
            const pricePerKg = parseFormattedNumber(document.getElementById('shed-bid-price-per-kg').value);
            const estimatedWeight = parseFormattedNumber(document.getElementById('shed-bid-estimated-weight').value);
            
            const totalPrice = pricePerKg * estimatedWeight;
            
            document.getElementById('display-price-per-kg').textContent = formatNumberFarsiDisplay(pricePerKg) + ' ریال';
            document.getElementById('display-estimated-weight').textContent = formatNumberFarsiDisplay(estimatedWeight) + ' کیلوگرم';
            
            document.getElementById('display-shed-total-price').textContent = formatNumberFarsiDisplay(totalPrice) + ' ریال';
            
            return {
                pricePerKg,
                estimatedWeight,
                totalPrice
            };
        }

        // ==================== اعتبارسنجی رمز عبور ====================
        function validatePassword() {
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-password-confirm').value;
            const errorElement = document.getElementById('password-match-error');
            
            if (password !== confirmPassword) {
                errorElement.textContent = 'رمز عبور و تکرار آن مطابقت ندارند';
                return false;
            } else {
                errorElement.textContent = '';
                return true;
            }
        }

        // ==================== مدیریت صفحات ====================
        function showPage(pageId) {
            // بستن همه مودال‌ها
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
            
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            document.getElementById(`${pageId}-page`).classList.remove('hidden');
            
            updateNavigation();
            
            if (pageId === 'dashboard' && currentUser && currentUser.userType === 'buyer') {
                loadDashboard();
            } else if (pageId === 'seller-formwork-dashboard' && currentUser && currentUser.userType === 'seller' && currentUser.sellerType === 'formwork') {
                loadFormworkSellerDashboard();
            } else if (pageId === 'seller-shed-dashboard' && currentUser && currentUser.userType === 'seller' && currentUser.sellerType === 'shed') {
                loadShedSellerDashboard();
            } else if (pageId === 'admin' && currentUser && currentUser.isAdmin) {
                loadAdminPanel();
            } else if (pageId === 'home') {
                loadCounters();
                initImageSlider();
            } else if (pageId === 'secondhand-shed') {
                loadSecondhandSheds();
            } else if (pageId === 'register') {
                // ریست کردن انتخاب‌ها در صفحه ثبت‌نام
                selectUserType('buyer');
                selectUserLegalType('company');
                if (document.getElementById('seller-type-section')) {
                    selectSellerType('formwork');
                }
            }
        }

        function updateNavigation() {
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');
            const sellerFormworkMenu = document.getElementById('seller-formwork-menu');
            const sellerShedMenu = document.getElementById('seller-shed-menu');
            const adminMenu = document.getElementById('admin-menu');
            
            if (currentUser) {
                authButtons.classList.add('hidden');
                if (currentUser.isAdmin) {
                    adminMenu.classList.remove('hidden');
                    userMenu.classList.add('hidden');
                    sellerFormworkMenu.classList.add('hidden');
                    sellerShedMenu.classList.add('hidden');
                } else if (currentUser.userType === 'buyer') {
                    userMenu.classList.remove('hidden');
                    adminMenu.classList.add('hidden');
                    sellerFormworkMenu.classList.add('hidden');
                    sellerShedMenu.classList.add('hidden');
                } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'formwork') {
                    sellerFormworkMenu.classList.remove('hidden');
                    userMenu.classList.add('hidden');
                    adminMenu.classList.add('hidden');
                    sellerShedMenu.classList.add('hidden');
                } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'shed') {
                    sellerShedMenu.classList.remove('hidden');
                    userMenu.classList.add('hidden');
                    adminMenu.classList.add('hidden');
                    sellerFormworkMenu.classList.add('hidden');
                }
            } else {
                authButtons.classList.remove('hidden');
                userMenu.classList.add('hidden');
                sellerFormworkMenu.classList.add('hidden');
                sellerShedMenu.classList.add('hidden');
                adminMenu.classList.add('hidden');
            }
        }

        // ==================== اسلایدشو عکس ====================
        function initImageSlider() {
            const images = document.querySelectorAll('.slider-image');
            if (images.length === 0) return;
            
            let currentIndex = 0;
            
            setInterval(() => {
                images[currentIndex].classList.remove('active');
                currentIndex = (currentIndex + 1) % images.length;
                images[currentIndex].classList.add('active');
            }, 5000);
        }

        // ==================== مدیریت کاربران ====================
        function selectUserType(type) {
            selectedUserType = type;
            // فقط دکمه‌های درون user-type-main-selector را فعال/غیرفعال کن
            const mainSelector = document.getElementById('user-type-main-selector');
            if (mainSelector) {
                mainSelector.querySelectorAll('.user-type-btn[data-type]').forEach(btn => {
                    if (btn.dataset.type === type) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
            
            // نمایش یا پنهان کردن بخش نوع فروشنده
            const sellerTypeSection = document.getElementById('seller-type-section');
            if (type === 'seller') {
                sellerTypeSection.classList.remove('hidden');
            } else {
                sellerTypeSection.classList.add('hidden');
            }
        }

        function selectUserLegalType(type) {
            selectedUserLegalType = type;
            const companyFields = document.getElementById('company-fields');
            const companyLabel = document.getElementById('company-label');
            
            // فقط دکمه‌های درون user-legal-type-selector را فعال/غیرفعال کن
            const legalTypeSelector = document.getElementById('user-legal-type-selector');
            if (legalTypeSelector) {
                legalTypeSelector.querySelectorAll('.user-type-btn[data-type]').forEach(btn => {
                    if (btn.dataset.type === type) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
            
            if (type === 'company') {
                companyFields.style.display = 'block';
                companyLabel.textContent = 'نام شرکت *';
                document.getElementById('reg-company').required = true;
            } else {
                companyFields.style.display = 'none';
                companyLabel.textContent = 'نام شرکت (اختیاری)';
                document.getElementById('reg-company').required = false;
            }
        }

        function selectSellerType(type) {
            selectedSellerType = type;
            // فقط دکمه‌های درون seller-type-selector را فعال/غیرفعال کن
            const sellerTypeSelector = document.getElementById('seller-type-selector');
            if (sellerTypeSelector) {
                sellerTypeSelector.querySelectorAll('.user-type-btn[data-type]').forEach(btn => {
                    if (btn.dataset.type === type) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
        }

// ==================== ثبت‌نام با Supabase ====================
document.getElementById('register-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    if (!validatePassword()) {
        return;
    }
    
    const email = document.getElementById('reg-email').value;
    const password = document.getElementById('reg-password').value;
    const company = document.getElementById('reg-company').value || '';
    const position = document.getElementById('reg-position').value || '';
    const contactPerson = document.getElementById('reg-contact').value;
    const phone = document.getElementById('reg-phone').value;
    
    try {
        // 1. ثبت‌نام در auth.users
        const { data: authData, error: authError } = await supabase.auth.signUp({
            email: email,
            password: password,
        });
        
        if (authError) throw authError;
        
        if (authData.user) {
            // 2. اضافه کردن به جدول profiles
            const { error: profileError } = await supabase
                .from('profiles')
                .insert([
                    {
                        user_id: authData.user.id,
                        email: email,
                        user_type: selectedUserType,
                        seller_type: selectedUserType === 'seller' ? selectedSellerType : null,
                        company_name: company,
                        position: position,
                        contact_person: contactPerson,
                        phone: phone,
                        user_legal_type: selectedUserLegalType,
                        verification_status: 'pending',
                        role: 'user',
                        created_at: new Date().toISOString(),
                        updated_at: new Date().toISOString()
                    }
                ]);
            
            if (profileError) throw profileError;
            
            // 3. ذخیره کاربر فعلی
            currentUser = {
                id: authData.user.id,
                email: email,
                userType: selectedUserType,
                sellerType: selectedUserType === 'seller' ? selectedSellerType : null,
                contactPerson: contactPerson,
                companyName: company,
                userLegalType: selectedUserLegalType,
                isAdmin: false
            };
            
            localStorage.setItem('current_user', JSON.stringify(currentUser));
            
            alert('✅ ثبت‌نام با موفقیت انجام شد! لطفاً ایمیل خود را تأیید کنید.');
            
            // 4. هدایت به صفحه مناسب
            if (selectedUserType === 'buyer') {
                showPage('dashboard');
            } else if (selectedUserType === 'seller' && selectedSellerType === 'formwork') {
                showPage('seller-formwork-dashboard');
            } else if (selectedUserType === 'seller' && selectedSellerType === 'shed') {
                showPage('seller-shed-dashboard');
            }
        }
        
    } catch (error) {
        console.error('خطا در ثبت‌نام:', error);
        document.getElementById('register-error').textContent = 
            error.message === 'User already registered' 
                ? 'این ایمیل قبلاً ثبت‌نام کرده است' 
                : 'خطا در ثبت‌نام. لطفاً مجدداً تلاش کنید.';
    }
});
        // ==================== فرم ورود ====================
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            const user = db.users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('current_user', JSON.stringify(currentUser));
                
                if (user.isAdmin) {
                    showPage('admin');
                } else if (user.userType === 'buyer') {
                    showPage('dashboard');
                } else if (user.userType === 'seller' && user.sellerType === 'formwork') {
                    showPage('seller-formwork-dashboard');
                } else if (user.userType === 'seller' && user.sellerType === 'shed') {
                    showPage('seller-shed-dashboard');
                }
            } else {
                document.getElementById('login-error').textContent = 'ایمیل یا رمز عبور اشتباه است';
            }
        });

        // ==================== بارگذاری شمارنده‌ها ====================
        function loadCounters() {
            const sellersCount = db.users.filter(u => u.userType === 'seller' && u.verificationStatus === 'verified').length;
            const buyersCount = db.users.filter(u => u.userType === 'buyer' && u.verificationStatus === 'verified').length;
            const transactionsCount = db.transactions.filter(t => t.status === 'completed').length + 
                                    db.shedTransactions.filter(t => t.status === 'completed').length;
            
            document.getElementById('counter-sellers').textContent = toPersianNumbers(sellersCount);
            document.getElementById('counter-buyers').textContent = toPersianNumbers(buyersCount);
            document.getElementById('counter-transactions').textContent = toPersianNumbers(transactionsCount);
        }

        // ==================== داشبورد خریدار ====================
        function loadDashboard() {
            if (!currentUser || currentUser.userType !== 'buyer') return;
            
            document.getElementById('user-name').textContent = currentUser.contactPerson;
            document.getElementById('user-type').textContent = `نوع حساب: ${currentUser.userLegalType === 'company' ? 'شرکتی' : 'حقیقی'}`;
            document.getElementById('user-avatar').textContent = currentUser.contactPerson.charAt(0);
            document.getElementById('buyer-actions').classList.remove('hidden');
            
            const userRequests = db.requests.filter(r => r.buyerId === currentUser.id).length;
            const userShedRequests = db.shedRequests.filter(r => r.buyerId === currentUser.id).length;
            const activeRequests = db.requests.filter(r => r.buyerId === currentUser.id && r.status === 'open').length;
            const totalBidsReceived = db.bids.filter(b => {
                const request = db.requests.find(r => r.id === b.requestId);
                return request && request.buyerId === currentUser.id;
            }).length;
            
            const statsGrid = document.getElementById('dashboard-stats');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <h3>درخواست‌های قالب</h3>
                    <div class="value">${toPersianNumbers(userRequests)}</div>
                </div>
                <div class="stat-card">
                    <h3>درخواست‌های سوله</h3>
                    <div class="value">${toPersianNumbers(userShedRequests)}</div>
                </div>
                <div class="stat-card">
                    <h3>پیشنهادهای دریافتی</h3>
                    <div class="value">${toPersianNumbers(totalBidsReceived)}</div>
                </div>
                <div class="stat-card">
                    <h3>معاملات موفق</h3>
                    <div class="value">${toPersianNumbers(currentUser.totalTransactions)}</div>
                </div>
            `;
        }

        // ==================== بارگذاری تمام درخواست‌ها ====================
        function loadAllRequests() {
            let content = document.getElementById('dashboard-content');
            let requests;
            
            if (currentUser && currentUser.isAdmin) {
                requests = db.requests;
                content = document.getElementById('admin-content');
            } else if (currentUser && currentUser.userType === 'buyer') {
                requests = db.requests.filter(r => r.buyerId === currentUser.id);
            } else {
                return;
            }
            
            if (requests.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز درخواستی ثبت نکرده‌اید.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            requests.forEach(request => {
                const statusBadge = getStatusBadge(request.status);
                const bidCount = db.bids.filter(b => b.requestId === request.id).length;
                const buyer = db.users.find(u => u.id === request.buyerId);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">${request.title}</div>
                            <span class="request-badge ${statusBadge.class}">${statusBadge.text}</span>
                        </div>
                        <div class="request-details">
                            <div><strong>اقلام:</strong> ${request.items ? request.items.join('، ') : 'تعیین نشده'}</div>
                            <div><strong>محل پروژه:</strong> ${request.projectLocation}</div>
                            <div><strong>تعداد پیشنهادها:</strong> ${toPersianNumbers(bidCount)}</div>
                            <div><strong>تاریخ ایجاد:</strong> ${formatDate(request.createdAt)}</div>
                            ${currentUser.isAdmin ? `<div><strong>خریدار:</strong> ${buyer ? buyer.contactPerson : 'ناشناس'}</div>` : ''}
                        </div>
                        <div class="request-actions">
                            ${request.status === 'open' && currentUser.userType === 'buyer' ? 
                                `<button class="btn btn-primary btn-sm" onclick="viewRequestBids(${request.id})">مشاهده پیشنهادها</button>` : ''}
                            <button class="btn btn-info btn-sm" onclick="viewRequestDetails(${request.id})">مشاهده جزئیات</button>
                            ${currentUser.isAdmin ? 
                                `<button class="btn btn-warning btn-sm" onclick="viewRequestBids(${request.id})">مشاهده پیشنهادها</button>` : ''}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        // ==================== بارگذاری درخواست‌های سوله خریدار ====================
        function loadShedRequests() {
            const content = document.getElementById('dashboard-content');
            const requests = db.shedRequests.filter(r => r.buyerId === currentUser.id);
            
            if (requests.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز درخواست سوله‌ای ثبت نکرده‌اید.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            requests.forEach(request => {
                const statusBadge = getStatusBadge(request.status);
                const bidCount = db.shedBids.filter(b => b.requestId === request.id).length;
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">درخواست سوله ${request.dimensions.length}x${request.dimensions.width} متر</div>
                            <span class="request-badge ${statusBadge.class}">${statusBadge.text}</span>
                        </div>
                        <div class="request-details">
                            <div><strong>ابعاد:</strong> ${request.dimensions.length}×${request.dimensions.width}×${request.dimensions.height} متر</div>
                            <div><strong>محل:</strong> ${request.location}</div>
                            <div><strong>کارکرد:</strong> ${request.usage}</div>
                            <div><strong>سندبلاست:</strong> ${request.sandblast === 'yes' ? 'بله' : 'خیر'}</div>
                            <div><strong>نوع رنگ:</strong> ${request.paintType}${request.otherPaintType ? ` (${request.otherPaintType})` : ''}</div>
                            <div><strong>ضخامت رنگ:</strong> ${request.paintThickness} میکرون</div>
                            <div><strong>تعداد پیشنهادها:</strong> ${toPersianNumbers(bidCount)}</div>
                            <div><strong>تاریخ ایجاد:</strong> ${formatDate(request.createdAt)}</div>
                        </div>
                        <div class="request-actions">
                            ${request.status === 'open' ? 
                                `<button class="btn btn-primary btn-sm" onclick="viewShedRequestBids(${request.id})">مشاهده پیشنهادها</button>` : ''}
                            <button class="btn btn-info btn-sm" onclick="viewShedRequestDetails(${request.id})">مشاهده جزئیات</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        // ==================== مدیریت درخواست‌ها ====================
        function showNewRequestModal() {
            if (!currentUser || currentUser.userType !== 'buyer') {
                alert('لطفاً ابتدا به عنوان خریدار وارد شوید.');
                showPage('login');
                return;
            }
            
            const futureDate = new Date();
            futureDate.setDate(futureDate.getDate() + 30);
            
            const yearSelect = document.getElementById('request-deadline-year');
            const monthSelect = document.getElementById('request-deadline-month');
            const daySelect = document.getElementById('request-deadline-day');
            
            const persianYear = futureDate.getFullYear() - 621;
            yearSelect.value = persianYear.toString();
            
            const monthIndex = futureDate.getMonth();
            const persianMonths = ['01','02','03','04','05','06','07','08','09','10','11','12'];
            monthSelect.value = persianMonths[monthIndex];
            
            daySelect.innerHTML = '<option value="">روز</option>';
            const daysInMonth = new Date(futureDate.getFullYear(), futureDate.getMonth() + 1, 0).getDate();
            for (let i = 1; i <= daysInMonth; i++) {
                const option = document.createElement('option');
                option.value = i.toString().padStart(2, '0');
                option.textContent = toPersianNumbers(i);
                if (i === futureDate.getDate()) {
                    option.selected = true;
                }
                daySelect.appendChild(option);
            }
            
            document.getElementById('new-request-modal').classList.add('active');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
            }
        }

        function previewRequestImage(event) {
            const input = event.target;
            const preview = document.getElementById('request-image-preview');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.classList.add('active');
                    currentRequestImages.push(e.target.result);
                    updateUploadedImages();
                }
                
                reader.readAsDataURL(input.files[0]);
            }
        }

        function updateUploadedImages() {
            const container = document.getElementById('uploaded-images');
            container.innerHTML = '';
            
            currentRequestImages.forEach((imgSrc, index) => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.className = 'uploaded-image';
                img.onclick = () => {
                    currentRequestImages.splice(index, 1);
                    updateUploadedImages();
                };
                container.appendChild(img);
            });
        }

        function submitNewRequest() {
            const title = document.getElementById('request-title').value;
            const description = document.getElementById('request-description').value;
            const material = document.getElementById('request-material').value;
            const projectLocation = document.getElementById('request-project-location').value;
            const year = document.getElementById('request-deadline-year').value;
            const month = document.getElementById('request-deadline-month').value;
            const day = document.getElementById('request-deadline-day').value;
            
            // جمع‌آوری اقلام انتخاب شده
            const selectedItems = Array.from(document.querySelectorAll('input[name="request-items"]:checked')).map(cb => cb.value);
            
            if (!title || !description || !material || !projectLocation || !year || !month || !day) {
                alert('لطفاً تمام فیلدهای ضروری را پر کنید.');
                return;
            }
            
            const newRequest = {
                id: db.requests.length + 1,
                title,
                description,
                items: selectedItems,
                material,
                projectLocation,
                deadline: `${year}/${month}/${day}`,
                buyerId: currentUser.id,
                status: 'open',
                createdAt: new Date().toISOString(),
                images: [...currentRequestImages]
            };
            
            db.requests.push(newRequest);
            db.saveAll();
            
            document.getElementById('new-request-form').reset();
            document.getElementById('request-image-preview').classList.remove('active');
            currentRequestImages = [];
            updateUploadedImages();
            
            closeModal('new-request-modal');
            alert('درخواست شما با موفقیت ثبت شد!');
            
            loadDashboard();
        }

        // ==================== پنل ادمین ====================
        function loadAdminPanel() {
            if (!currentUser || !currentUser.isAdmin) {
                showPage('home');
                return;
            }
            
            const totalUsers = db.users.length;
            const totalBuyers = db.users.filter(u => u.userType === 'buyer').length;
            const formworkSellers = db.getFormworkSellers().length;
            const shedSellers = db.getShedSellers().length;
            const totalRequests = db.requests.length + db.shedRequests.length;
            const totalTransactions = db.transactions.filter(t => t.status === 'completed').length + 
                                    db.shedTransactions.filter(t => t.status === 'completed').length;
            
            document.getElementById('admin-total-users').textContent = toPersianNumbers(totalUsers);
            document.getElementById('admin-total-buyers').textContent = toPersianNumbers(totalBuyers);
            document.getElementById('admin-formwork-sellers').textContent = toPersianNumbers(formworkSellers);
            document.getElementById('admin-shed-sellers').textContent = toPersianNumbers(shedSellers);
            document.getElementById('admin-total-requests').textContent = toPersianNumbers(totalRequests);
            document.getElementById('admin-total-transactions').textContent = toPersianNumbers(totalTransactions);
        }

        function loadAllUsers() {
            const content = document.getElementById('admin-content');
            
            let html = '<div class="requests-list">';
            
            db.users.forEach(user => {
                let userTypeText = '';
                if (user.isAdmin) {
                    userTypeText = 'ادمین';
                } else if (user.userType === 'buyer') {
                    userTypeText = 'خریدار';
                } else if (user.userType === 'seller') {
                    userTypeText = `فروشنده ${user.sellerType === 'formwork' ? 'قالب' : 'سوله'}`;
                }
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">${user.contactPerson}</div>
                            <span class="request-badge ${user.isAdmin ? 'badge-warning' : user.userType === 'buyer' ? 'badge-open' : user.sellerType === 'formwork' ? 'badge-success' : 'badge-info'}">
                                ${userTypeText}
                            </span>
                        </div>
                        <div class="request-details">
                            <div><strong>ایمیل:</strong> ${user.email}</div>
                            <div><strong>شرکت:</strong> ${user.companyName || 'ثبت نشده'}</div>
                            <div><strong>تلفن:</strong> ${user.phone}</div>
                            <div><strong>وضعیت:</strong> ${user.verificationStatus === 'verified' ? 'تایید شده' : 'در انتظار تایید'}</div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        function loadAllShedRequests() {
            const content = document.getElementById('admin-content');
            const requests = db.shedRequests;
            
            if (requests.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز درخواست سوله‌ای ثبت نشده است.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            requests.forEach(request => {
                const statusBadge = getStatusBadge(request.status);
                const bidCount = db.shedBids.filter(b => b.requestId === request.id).length;
                const buyer = db.users.find(u => u.id === request.buyerId);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">درخواست سوله ${request.dimensions.length}x${request.dimensions.width} متر</div>
                            <span class="request-badge ${statusBadge.class}">${statusBadge.text}</span>
                        </div>
                        <div class="request-details">
                            <div><strong>ابعاد:</strong> ${request.dimensions.length}×${request.dimensions.width}×${request.dimensions.height} متر</div>
                            <div><strong>محل:</strong> ${request.location}</div>
                            <div><strong>کارکرد:</strong> ${request.usage}</div>
                            <div><strong>سندبلاست:</strong> ${request.sandblast === 'yes' ? 'بله' : 'خیر'}</div>
                            <div><strong>نوع رنگ:</strong> ${request.paintType}${request.otherPaintType ? ` (${request.otherPaintType})` : ''}</div>
                            <div><strong>ضخامت رنگ:</strong> ${request.paintThickness} میکرون</div>
                            <div><strong>خریدار:</strong> ${buyer ? buyer.contactPerson : 'ناشناس'}</div>
                            <div><strong>تعداد پیشنهادها:</strong> ${toPersianNumbers(bidCount)}</div>
                            <div><strong>تاریخ ایجاد:</strong> ${formatDate(request.createdAt)}</div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        function loadAllTransactions() {
            const content = document.getElementById('admin-content');
            
            const allTransactions = [
                ...db.transactions.map(t => ({...t, type: 'قالب'})),
                ...db.shedTransactions.map(t => ({...t, type: 'سوله'}))
            ].sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            if (allTransactions.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز تراکنشی ثبت نشده است.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            allTransactions.forEach(transaction => {
                const buyer = db.users.find(u => u.id === transaction.buyerId);
                const seller = db.users.find(u => u.id === transaction.sellerId);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">تراکنش ${transaction.type} شماره ${transaction.id}</div>
                            <span class="request-badge ${transaction.status === 'completed' ? 'badge-success' : 'badge-warning'}">
                                ${transaction.status === 'completed' ? 'تکمیل شده' : 'در حال انجام'}
                            </span>
                        </div>
                        <div class="request-details">
                            <div><strong>خریدار:</strong> ${buyer ? buyer.contactPerson : 'ناشناس'}</div>
                            <div><strong>فروشنده:</strong> ${seller ? seller.contactPerson : 'ناشناس'}</div>
                            <div><strong>مبلغ:</strong> ${formatNumberFarsiDisplay(transaction.amount)} ریال</div>
                            <div><strong>تاریخ:</strong> ${formatDate(transaction.createdAt)}</div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        // ==================== داشبورد فروشنده قالب ====================
        function loadFormworkSellerDashboard() {
            if (!currentUser || currentUser.userType !== 'seller' || currentUser.sellerType !== 'formwork') return;
            
            document.getElementById('seller-formwork-name').textContent = currentUser.contactPerson;
            document.getElementById('seller-formwork-type').textContent = 'حساب فروشنده قالب';
            document.getElementById('seller-formwork-avatar').textContent = currentUser.contactPerson.charAt(0);
            
            const sellerBids = db.bids.filter(b => b.sellerId === currentUser.id).length;
            const activeBids = db.bids.filter(b => b.sellerId === currentUser.id && b.status === 'submitted').length;
            const wonBids = db.bids.filter(b => b.sellerId === currentUser.id && b.status === 'accepted').length;
            const openRequests = db.getOpenRequests().length;
            
            const statsGrid = document.getElementById('seller-formwork-stats');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <h3>درخواست‌های باز</h3>
                    <div class="value">${toPersianNumbers(openRequests)}</div>
                </div>
                <div class="stat-card">
                    <h3>پیشنهادهای ارسالی</h3>
                    <div class="value">${toPersianNumbers(sellerBids)}</div>
                </div>
                <div class="stat-card">
                    <h3>پیشنهادهای پذیرفته شده</h3>
                    <div class="value">${toPersianNumbers(wonBids)}</div>
                </div>
                <div class="stat-card">
                    <h3>معاملات موفق</h3>
                    <div class="value">${toPersianNumbers(currentUser.totalTransactions)}</div>
                </div>
            `;
        }

        function loadFormworkSellerRequests() {
            const content = document.getElementById('seller-formwork-dashboard-content');
            const openRequests = db.getOpenRequests();
            
            if (openRequests.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">در حال حاضر درخواست بازی وجود ندارد.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            openRequests.forEach(request => {
                const hasBid = db.bids.some(b => b.requestId === request.id && b.sellerId === currentUser.id);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">${request.title}</div>
                            <span class="request-badge badge-open">باز</span>
                        </div>
                        <div class="request-details">
                            <div><strong>اقلام:</strong> ${request.items ? request.items.join('، ') : 'تعیین نشده'}</div>
                            <div><strong>محل پروژه:</strong> ${request.projectLocation}</div>
                            <div><strong>جنس قالب:</strong> ${request.material}</div>
                            <div><strong>مهلت:</strong> ${request.deadline}</div>
                        </div>
                        <div class="request-actions">
                            ${!hasBid ? 
                                `<button class="btn btn-primary btn-sm" onclick="submitBidForRequest(${request.id})">ارسال پیشنهاد</button>` : 
                                `<button class="btn btn-secondary btn-sm" disabled>پیشنهاد ارسال شده</button>`
                            }
                            <button class="btn btn-info btn-sm" onclick="viewRequestDetails(${request.id})">مشاهده جزئیات</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        function loadFormworkSellerBids() {
            const content = document.getElementById('seller-formwork-dashboard-content');
            const sellerBids = db.getBidsBySeller(currentUser.id);
            
            if (sellerBids.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز پیشنهادی ارسال نکرده‌اید.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            sellerBids.forEach(bid => {
                const request = db.requests.find(r => r.id === bid.requestId);
                const statusBadge = getStatusBadge(bid.status);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">${request ? request.title : 'پروژه نامشخص'}</div>
                            <span class="request-badge ${statusBadge.class}">${statusBadge.text}</span>
                        </div>
                        <div class="request-details">
                            <div><strong>مبلغ پیشنهادی:</strong> ${formatNumberFarsiDisplay(bid.basePrice)} ریال</div>
                            <div><strong>زمان تحویل:</strong> ${bid.deliveryDays} روز</div>
                            <div><strong>تاریخ ارسال:</strong> ${formatDate(bid.createdAt)}</div>
                        </div>
                        <div class="request-actions">
                            <button class="btn btn-info btn-sm" onclick="viewBidDetails(${bid.id})">مشاهده جزئیات</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        // ==================== داشبورد فروشنده سوله ====================
        function loadShedSellerDashboard() {
            if (!currentUser || currentUser.userType !== 'seller' || currentUser.sellerType !== 'shed') return;
            
            document.getElementById('seller-shed-name').textContent = currentUser.contactPerson;
            document.getElementById('seller-shed-type').textContent = 'حساب فروشنده سوله';
            document.getElementById('seller-shed-avatar').textContent = currentUser.contactPerson.charAt(0);
            
            const sellerBids = db.shedBids.filter(b => b.sellerId === currentUser.id).length;
            const activeBids = db.shedBids.filter(b => b.sellerId === currentUser.id && b.status === 'submitted').length;
            const wonBids = db.shedBids.filter(b => b.sellerId === currentUser.id && b.status === 'accepted').length;
            const openRequests = db.getOpenShedRequests().length;
            
            const statsGrid = document.getElementById('seller-shed-stats');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <h3>درخواست‌های باز</h3>
                    <div class="value">${toPersianNumbers(openRequests)}</div>
                </div>
                <div class="stat-card">
                    <h3>پیشنهادهای ارسالی</h3>
                    <div class="value">${toPersianNumbers(sellerBids)}</div>
                </div>
                <div class="stat-card">
                    <h3>پیشنهادهای پذیرفته شده</h3>
                    <div class="value">${toPersianNumbers(wonBids)}</div>
                </div>
                <div class="stat-card">
                    <h3>معاملات موفق</h3>
                    <div class="value">${toPersianNumbers(currentUser.totalTransactions)}</div>
                </div>
            `;
        }

        function loadShedSellerRequests() {
            const content = document.getElementById('seller-shed-dashboard-content');
            const openRequests = db.getOpenShedRequests();
            
            if (openRequests.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">در حال حاضر درخواست سوله‌ای وجود ندارد.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            openRequests.forEach(request => {
                const hasBid = db.shedBids.some(b => b.requestId === request.id && b.sellerId === currentUser.id);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">درخواست سوله ${request.dimensions.length}x${request.dimensions.width} متر</div>
                            <span class="request-badge badge-open">باز</span>
                        </div>
                        <div class="request-details">
                            <div><strong>ابعاد:</strong> ${request.dimensions.length}×${request.dimensions.width}×${request.dimensions.height} متر</div>
                            <div><strong>محل:</strong> ${request.location}</div>
                            <div><strong>کارکرد:</strong> ${request.usage}</div>
                            <div><strong>سندبلاست:</strong> ${request.sandblast === 'yes' ? 'بله' : 'خیر'}</div>
                            <div><strong>نوع رنگ:</strong> ${request.paintType}${request.otherPaintType ? ` (${request.otherPaintType})` : ''}</div>
                            <div><strong>ضخامت رنگ:</strong> ${request.paintThickness} میکرون</div>
                            ${request.needsCrane ? `<div><strong>جرثقیل:</strong> ${request.craneTonnage} تن</div>` : ''}
                        </div>
                        <div class="request-actions">
                            ${!hasBid ? 
                                `<button class="btn btn-primary btn-sm" onclick="submitShedBidForRequest(${request.id})">ارسال پیشنهاد</button>` : 
                                `<button class="btn btn-secondary btn-sm" disabled>پیشنهاد ارسال شده</button>`
                            }
                            <button class="btn btn-info btn-sm" onclick="viewShedRequestDetails(${request.id})">مشاهده جزئیات</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        function loadShedSellerBids() {
            const content = document.getElementById('seller-shed-dashboard-content');
            const sellerBids = db.getShedBidsBySeller(currentUser.id);
            
            if (sellerBids.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز پیشنهادی ارسال نکرده‌اید.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            sellerBids.forEach(bid => {
                const request = db.shedRequests.find(r => r.id === bid.requestId);
                const statusBadge = getStatusBadge(bid.status);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">سوله ${request ? `${request.dimensions.length}x${request.dimensions.width} متر` : 'نامشخص'}</div>
                            <span class="request-badge ${statusBadge.class}">${statusBadge.text}</span>
                        </div>
                        <div class="request-details">
                            <div><strong>قیمت هر کیلوگرم:</strong> ${formatNumberFarsiDisplay(bid.pricePerKg)} ریال</div>
                            <div><strong>وزن حدودی:</strong> ${formatNumberFarsiDisplay(bid.estimatedWeight)} کیلوگرم</div>
                            <div><strong>قیمت کل:</strong> ${formatNumberFarsiDisplay(bid.totalPrice)} ریال</div>
                            <div><strong>زمان تحویل:</strong> ${bid.deliveryDays} روز</div>
                            <div><strong>تاریخ ارسال:</strong> ${formatDate(bid.createdAt)}</div>
                        </div>
                        <div class="request-actions">
                            <button class="btn btn-info btn-sm" onclick="viewShedBidDetails(${bid.id})">مشاهده جزئیات</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        // ==================== توابع جدید برای نمایش جزئیات ====================
        function viewRequestDetails(requestId) {
            const request = db.requests.find(r => r.id === requestId);
            if (!request) {
                alert('درخواست یافت نشد');
                return;
            }

            const buyer = db.users.find(u => u.id === request.buyerId);
            const bidsCount = db.bids.filter(b => b.requestId === requestId).length;

            let detailsHtml = `
                <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #1e3a8a; margin-bottom: 15px;">${request.title}</h3>
                    <div style="margin-bottom: 10px;"><strong>توضیحات:</strong> ${request.description}</div>
                    <div style="margin-bottom: 10px;"><strong>اقلام درخواستی:</strong> ${request.items ? request.items.join('، ') : 'تعیین نشده'}</div>
                    <div style="margin-bottom: 10px;"><strong>جنس قالب:</strong> ${request.material}</div>
                    <div style="margin-bottom: 10px;"><strong>محل پروژه:</strong> ${request.projectLocation}</div>
                    <div style="margin-bottom: 10px;"><strong>مهلت ارسال پیشنهاد:</strong> ${request.deadline}</div>
                    <div style="margin-bottom: 10px;"><strong>تعداد پیشنهادها:</strong> ${bidsCount}</div>
                    <div style="margin-bottom: 10px;"><strong>خریدار:</strong> ${buyer ? buyer.contactPerson : 'ناشناس'}</div>
                    <div style="margin-bottom: 10px;"><strong>وضعیت:</strong> ${getStatusBadge(request.status).text}</div>
                    <div style="margin-top: 20px;">
                        ${currentUser.userType === 'seller' && currentUser.sellerType === 'formwork' ? 
                            `<button class="btn btn-primary" onclick="submitBidForRequest(${requestId}); closeModal('request-details-modal')">ارسال پیشنهاد</button>` : ''}
                        <button class="btn btn-secondary" onclick="closeModal('request-details-modal')">بستن</button>
                    </div>
                </div>
            `;

            // ایجاد مودال برای نمایش جزئیات
            const modal = document.createElement('div');
            modal.id = 'request-details-modal';
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3>جزئیات درخواست</h3>
                        <button class="close-modal" onclick="closeModal('request-details-modal')">&times;</button>
                    </div>
                    <div class="modal-body">
                        ${detailsHtml}
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function viewShedRequestDetails(requestId) {
            const request = db.shedRequests.find(r => r.id === requestId);
            if (!request) {
                alert('درخواست سوله یافت نشد');
                return;
            }

            const buyer = db.users.find(u => u.id === request.buyerId);
            const bidsCount = db.shedBids.filter(b => b.requestId === requestId).length;

            // ترجمه مسئولیت‌های خریدار
            const responsibilityLabels = {
                'steel': 'تهیه آهن آلات',
                'bolts': 'تهیه پیچ و مهره',
                'transport': 'حمل'
            };
            
            const responsibilities = request.buyerResponsibilities && request.buyerResponsibilities.length > 0 
                ? request.buyerResponsibilities.map(resp => responsibilityLabels[resp] || resp).join('، ')
                : 'هیچ مسئولیتی را به عهده نگرفته است.';

            let detailsHtml = `
                <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #1e3a8a; margin-bottom: 15px;">درخواست سوله ${request.dimensions.length}x${request.dimensions.width} متر</h3>
                    <div style="margin-bottom: 10px;"><strong>ابعاد:</strong> ${request.dimensions.length}×${request.dimensions.width}×${request.dimensions.height} متر</div>
                    <div style="margin-bottom: 10px;"><strong>کارکرد:</strong> ${request.usage}</div>
                    <div style="margin-bottom: 10px;"><strong>محل:</strong> ${request.location}</div>
                    <div style="margin-bottom: 10px;"><strong>نقشه:</strong> ${request.hasDrawing ? 'دارد' : 'نیاز به طراحی دارد'}</div>
                    <div style="margin-bottom: 10px;"><strong>جرثقیل:</strong> ${request.needsCrane ? `${request.craneTonnage} تن` : 'نیاز ندارد'}</div>
                    <div style="margin-bottom: 10px;"><strong>فونداسیون:</strong> ${request.foundation === 'yes' ? 'آماده است' : 'نیاز به اجرا دارد'}</div>
                    <div style="margin-bottom: 10px;"><strong>سندبلاست:</strong> ${request.sandblast === 'yes' ? 'بله' : 'خیر'}</div>
                    <div style="margin-bottom: 10px;"><strong>نوع رنگ:</strong> ${request.paintType}${request.otherPaintType ? ` (${request.otherPaintType})` : ''}</div>
                    <div style="margin-bottom: 10px;"><strong>ضخامت رنگ:</strong> ${request.paintThickness} میکرون</div>
                    <div style="margin-bottom: 10px;"><strong>مسئولیت خریدار:</strong> ${responsibilities}</div>
                    <div style="margin-bottom: 10px;"><strong>تعداد پیشنهادها:</strong> ${bidsCount}</div>
                    <div style="margin-bottom: 10px;"><strong>خریدار:</strong> ${buyer ? buyer.contactPerson : 'ناشناس'}</div>
                    <div style="margin-bottom: 10px;"><strong>وضعیت:</strong> ${getStatusBadge(request.status).text}</div>
                    <div style="margin-top: 20px;">
                        ${currentUser.userType === 'seller' && currentUser.sellerType === 'shed' ? 
                            `<button class="btn btn-primary" onclick="submitShedBidForRequest(${requestId}); closeModal('shed-request-details-modal')">ارسال پیشنهاد</button>` : ''}
                        <button class="btn btn-secondary" onclick="closeModal('shed-request-details-modal')">بستن</button>
                    </div>
                </div>
            `;

            // ایجاد مودال برای نمایش جزئیات
            const modal = document.createElement('div');
            modal.id = 'shed-request-details-modal';
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3>جزئیات درخواست سوله</h3>
                        <button class="close-modal" onclick="closeModal('shed-request-details-modal')">&times;</button>
                    </div>
                    <div class="modal-body">
                        ${detailsHtml}
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function viewBidDetails(bidId) {
            const bid = db.bids.find(b => b.id === bidId);
            if (!bid) {
                alert('پیشنهاد یافت نشد');
                return;
            }

            const request = db.requests.find(r => r.id === bid.requestId);
            const seller = db.users.find(u => u.id === bid.sellerId);
            const totalPrice = bid.basePrice + (bid.basePrice * bid.vatPercentage / 100) + (bid.basePrice * bid.loadingPercentage / 100);

            let detailsHtml = `
                <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #1e3a8a; margin-bottom: 15px;">جزئیات پیشنهاد</h3>
                    ${request ? `<div style="margin-bottom: 10px;"><strong>پروژه:</strong> ${request.title}</div>` : ''}
                    ${seller ? `<div style="margin-bottom: 10px;"><strong>فروشنده:</strong> ${seller.companyName || seller.contactPerson}</div>` : ''}
                    <div style="margin-bottom: 10px;"><strong>قیمت پایه:</strong> ${formatNumberFarsiDisplay(bid.basePrice)} ریال</div>
                    <div style="margin-bottom: 10px;"><strong>ارزش افزوده:</strong> ${bid.vatPercentage}%</div>
                    <div style="margin-bottom: 10px;"><strong>بارگیری:</strong> ${bid.loadingPercentage}%</div>
                    <div style="margin-bottom: 10px;"><strong>قیمت کل:</strong> ${formatNumberFarsiDisplay(totalPrice)} ریال</div>
                    <div style="margin-bottom: 10px;"><strong>زمان تحویل:</strong> ${bid.deliveryDays} روز</div>
                    <div style="margin-bottom: 10px;"><strong>گارانتی:</strong> ${bid.warrantyMonths} ماه</div>
                    ${bid.notes ? `<div style="margin-bottom: 10px;"><strong>توضیحات:</strong> ${bid.notes}</div>` : ''}
                    <div style="margin-bottom: 10px;"><strong>وضعیت:</strong> ${bid.status === 'submitted' ? 'در انتظار بررسی' : bid.status === 'accepted' ? 'پذیرفته شده' : 'رد شده'}</div>
                    <div style="margin-top: 20px;">
                        <button class="btn btn-secondary" onclick="closeModal('bid-details-modal')">بستن</button>
                    </div>
                </div>
            `;

            // ایجاد مودال برای نمایش جزئیات پیشنهاد
            const modal = document.createElement('div');
            modal.id = 'bid-details-modal';
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3>جزئیات پیشنهاد</h3>
                        <button class="close-modal" onclick="closeModal('bid-details-modal')">&times;</button>
                    </div>
                    <div class="modal-body">
                        ${detailsHtml}
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function viewShedBidDetails(bidId) {
            const bid = db.shedBids.find(b => b.id === bidId);
            if (!bid) {
                alert('پیشنهاد سوله یافت نشد');
                return;
            }

            const request = db.shedRequests.find(r => r.id === bid.requestId);
            const seller = db.users.find(u => u.id === bid.sellerId);

            let detailsHtml = `
                <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h3 style="color: #1e3a8a; margin-bottom: 15px;">جزئیات پیشنهاد سوله</h3>
                    ${request ? `<div style="margin-bottom: 10px;"><strong>سوله:</strong> ${request.dimensions.length}x${request.dimensions.width} متر</div>` : ''}
                    ${seller ? `<div style="margin-bottom: 10px;"><strong>فروشنده:</strong> ${seller.companyName || seller.contactPerson}</div>` : ''}
                    <div style="margin-bottom: 10px;"><strong>قیمت هر کیلوگرم:</strong> ${formatNumberFarsiDisplay(bid.pricePerKg)} ریال</div>
                    <div style="margin-bottom: 10px;"><strong>وزن حدودی:</strong> ${formatNumberFarsiDisplay(bid.estimatedWeight)} کیلوگرم</div>
                    <div style="margin-bottom: 10px;"><strong>قیمت کل:</strong> ${formatNumberFarsiDisplay(bid.totalPrice)} ریال</div>
                    <div style="margin-bottom: 10px;"><strong>زمان تحویل:</strong> ${bid.deliveryDays} روز</div>
                    <div style="margin-bottom: 10px;"><strong>گارانتی:</strong> ${bid.warrantyMonths} ماه</div>
                    ${bid.notes ? `<div style="margin-bottom: 10px;"><strong>توضیحات:</strong> ${bid.notes}</div>` : ''}
                    <div style="margin-bottom: 10px;"><strong>وضعیت:</strong> ${bid.status === 'submitted' ? 'در انتظار بررسی' : bid.status === 'accepted' ? 'پذیرفته شده' : 'رد شده'}</div>
                    <div style="margin-top: 20px;">
                        <button class="btn btn-secondary" onclick="closeModal('shed-bid-details-modal')">بستن</button>
                    </div>
                </div>
            `;

            // ایجاد مودال برای نمایش جزئیات پیشنهاد
            const modal = document.createElement('div');
            modal.id = 'shed-bid-details-modal';
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 600px;">
                    <div class="modal-header">
                        <h3>جزئیات پیشنهاد سوله</h3>
                        <button class="close-modal" onclick="closeModal('shed-bid-details-modal')">&times;</button>
                    </div>
                    <div class="modal-body">
                        ${detailsHtml}
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        // ==================== توابع پیشنهاد ====================
        function submitBidForRequest(requestId) {
            const request = db.requests.find(r => r.id === requestId);
            if (!request) return;
            
            document.getElementById('bid-project-title').textContent = request.title;
            document.getElementById('bid-request-id').value = requestId;
            
            const modal = document.getElementById('submit-bid-modal');
            modal.classList.add('active');
            
            calculateTotalPrice();
        }

        function submitShedBidForRequest(requestId) {
            const request = db.shedRequests.find(r => r.id === requestId);
            if (!request) return;
            
            document.getElementById('shed-bid-project-title').textContent = `سوله ${request.dimensions.length}x${request.dimensions.width} متر - ${request.location}`;
            document.getElementById('shed-bid-request-id').value = requestId;
            
            // نمایش مسئولیت‌های خریدار
            const responsibilitiesList = document.getElementById('shed-bid-responsibilities-list');
            if (request.buyerResponsibilities && request.buyerResponsibilities.length > 0) {
                // ترجمه مسئولیت‌ها به فارسی
                const responsibilityLabels = {
                    'steel': 'تهیه آهن آلات',
                    'bolts': 'تهیه پیچ و مهره',
                    'transport': 'حمل'
                };
                
                const responsibilities = request.buyerResponsibilities.map(resp => responsibilityLabels[resp] || resp).join('، ');
                responsibilitiesList.textContent = responsibilities;
            } else {
                responsibilitiesList.textContent = 'هیچ مسئولیتی را به عهده نگرفته است.';
            }
            
            const modal = document.getElementById('submit-shed-bid-modal');
            modal.classList.add('active');
            
            // محاسبه اولیه قیمت کل
            calculateShedTotalPrice();
        }

        function previewBidImage(event) {
            const input = event.target;
            const preview = document.getElementById('bid-image-preview');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.classList.add('active');
                    currentBidImages.push(e.target.result);
                    updateBidUploadedImages();
                }
                
                reader.readAsDataURL(input.files[0]);
            }
        }

        function updateBidUploadedImages() {
            const container = document.getElementById('bid-uploaded-images');
            container.innerHTML = '';
            
            currentBidImages.forEach((imgSrc, index) => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.className = 'uploaded-image';
                img.onclick = () => {
                    currentBidImages.splice(index, 1);
                    updateBidUploadedImages();
                };
                container.appendChild(img);
            });
        }

        function submitBid() {
            const requestId = parseInt(document.getElementById('bid-request-id').value);
            const basePrice = parseFormattedNumber(document.getElementById('bid-base-price').value);
            const vatPercentage = parseFloat(document.getElementById('bid-vat-percentage').value);
            const loadingPercentage = parseFloat(document.getElementById('bid-loading-percentage').value);
            const deliveryDays = parseInt(document.getElementById('bid-delivery').value);
            const warrantyMonths = parseInt(document.getElementById('bid-warranty').value);
            const notes = document.getElementById('bid-notes').value;
            
            if (!requestId || !basePrice || !deliveryDays) {
                alert('لطفاً تمام فیلدهای ضروری را پر کنید.');
                return;
            }
            
            const newBid = {
                id: db.bids.length + 1,
                requestId,
                sellerId: currentUser.id,
                basePrice,
                vatPercentage,
                loadingPercentage,
                deliveryDays,
                warrantyMonths,
                notes,
                status: 'submitted',
                createdAt: new Date().toISOString(),
                images: [...currentBidImages]
            };
            
            db.bids.push(newBid);
            db.saveAll();
            
            document.getElementById('submit-bid-form').reset();
            document.getElementById('bid-image-preview').classList.remove('active');
            currentBidImages = [];
            updateBidUploadedImages();
            
            closeModal('submit-bid-modal');
            alert('پیشنهاد شما با موفقیت ارسال شد!');
            
            loadFormworkSellerDashboard();
        }

        function submitShedBid() {
            const requestId = parseInt(document.getElementById('shed-bid-request-id').value);
            const pricePerKg = parseFormattedNumber(document.getElementById('shed-bid-price-per-kg').value);
            const estimatedWeight = parseFormattedNumber(document.getElementById('shed-bid-estimated-weight').value);
            const deliveryDays = parseInt(document.getElementById('shed-bid-delivery').value);
            const warrantyMonths = parseInt(document.getElementById('shed-bid-warranty').value);
            const notes = document.getElementById('shed-bid-notes').value;
            
            if (!requestId || !pricePerKg || !estimatedWeight || !deliveryDays) {
                alert('لطفاً تمام فیلدهای ضروری را پر کنید.');
                return;
            }
            
            const totalPrice = pricePerKg * estimatedWeight;
            
            const newBid = {
                id: db.shedBids.length + 1,
                requestId,
                sellerId: currentUser.id,
                pricePerKg,
                estimatedWeight,
                totalPrice,
                deliveryDays,
                warrantyMonths,
                notes,
                status: 'submitted',
                createdAt: new Date().toISOString()
            };
            
            db.addShedBid(newBid);
            
            document.getElementById('submit-shed-bid-form').reset();
            
            closeModal('submit-shed-bid-modal');
            alert('پیشنهاد شما با موفقیت ارسال شد!');
            
            loadShedSellerDashboard();
        }

        // ==================== توابع عمومی ====================
        function viewRequestBids(requestId) {
            const request = db.requests.find(r => r.id === requestId);
            const bids = db.getBidsByRequest(requestId);
            
            let html = '<div class="requests-list">';
            
            if (bids.length === 0) {
                html += `
                    <div class="request-item">
                        <p style="text-align: center; color: #6b7280;">هنوز پیشنهادی برای این درخواست ارسال نشده است.</p>
                    </div>
                `;
            } else {
                bids.forEach(bid => {
                    const seller = db.users.find(u => u.id === bid.sellerId);
                    const totalPrice = bid.basePrice + (bid.basePrice * bid.vatPercentage / 100) + (bid.basePrice * bid.loadingPercentage / 100);
                    
                    html += `
                        <div class="request-item">
                            <div class="request-header">
                                <div class="request-title">پیشنهاد از ${seller ? seller.companyName : 'فروشنده ناشناس'}</div>
                                <span class="request-badge ${bid.status === 'accepted' ? 'badge-success' : 'badge-primary'}">
                                    ${bid.status === 'accepted' ? 'پذیرفته شده' : 'در انتظار بررسی'}
                                </span>
                            </div>
                            <div class="request-details">
                                <div><strong>قیمت کل:</strong> ${formatNumberFarsiDisplay(totalPrice)} ریال</div>
                                <div><strong>زمان تحویل:</strong> ${bid.deliveryDays} روز</div>
                                <div><strong>گارانتی:</strong> ${bid.warrantyMonths} ماه</div>
                                <div><strong>امتیاز فروشنده:</strong> ${seller ? seller.rating.toFixed(1) : '0'} از ۵</div>
                            </div>
                            ${currentUser.userType === 'buyer' && bid.status !== 'accepted' ? `
                                <div class="request-actions">
                                    <button class="btn btn-success btn-sm" onclick="acceptBid(${bid.id})">پذیرش پیشنهاد</button>
                                    <button class="btn btn-info btn-sm" onclick="viewBidDetails(${bid.id})">جزئیات بیشتر</button>
                                </div>
                            ` : ''}
                        </div>
                    `;
                });
            }
            
            html += '</div>';
            
            const modal = document.getElementById('view-bids-modal');
            const bidsList = document.getElementById('bids-list');
            bidsList.innerHTML = html;
            modal.classList.add('active');
        }

        function viewShedRequestBids(requestId) {
            const request = db.shedRequests.find(r => r.id === requestId);
            const bids = db.getShedBidsByRequest(requestId);
            
            let html = '<div class="requests-list">';
            
            if (bids.length === 0) {
                html += `
                    <div class="request-item">
                        <p style="text-align: center; color: #6b7280;">هنوز پیشنهادی برای این درخواست سوله ارسال نشده است.</p>
                    </div>
                `;
            } else {
                bids.forEach(bid => {
                    const seller = db.users.find(u => u.id === bid.sellerId);
                    
                    html += `
                        <div class="request-item">
                            <div class="request-header">
                                <div class="request-title">پیشنهاد از ${seller ? seller.companyName : 'فروشنده ناشناس'}</div>
                                <span class="request-badge ${bid.status === 'accepted' ? 'badge-success' : 'badge-primary'}">
                                    ${bid.status === 'accepted' ? 'پذیرفته شده' : 'در انتظار بررسی'}
                                </span>
                            </div>
                            <div class="request-details">
                                <div><strong>قیمت هر کیلوگرم:</strong> ${formatNumberFarsiDisplay(bid.pricePerKg)} ریال</div>
                                <div><strong>وزن حدودی:</strong> ${formatNumberFarsiDisplay(bid.estimatedWeight)} کیلوگرم</div>
                                <div><strong>قیمت کل:</strong> ${formatNumberFarsiDisplay(bid.totalPrice)} ریال</div>
                                <div><strong>زمان تحویل:</strong> ${bid.deliveryDays} روز</div>
                                <div><strong>گارانتی:</strong> ${bid.warrantyMonths} ماه</div>
                                <div><strong>امتیاز فروشنده:</strong> ${seller ? seller.rating.toFixed(1) : '0'} از ۵</div>
                            </div>
                            ${currentUser.userType === 'buyer' && bid.status !== 'accepted' ? `
                                <div class="request-actions">
                                    <button class="btn btn-success btn-sm" onclick="acceptShedBid(${bid.id})">پذیرش پیشنهاد</button>
                                    <button class="btn btn-info btn-sm" onclick="viewShedBidDetails(${bid.id})">جزئیات بیشتر</button>
                                </div>
                            ` : ''}
                        </div>
                    `;
                });
            }
            
            html += '</div>';
            
            const modal = document.getElementById('view-shed-bids-modal');
            const bidsList = document.getElementById('shed-bids-list');
            bidsList.innerHTML = html;
            modal.classList.add('active');
        }

        function acceptBid(bidId) {
            const bid = db.bids.find(b => b.id === bidId);
            if (!bid) return;
            
            if (confirm('آیا از پذیرش این پیشنهاد اطمینان دارید؟')) {
                bid.status = 'accepted';
                
                const request = db.requests.find(r => r.id === bid.requestId);
                if (request) {
                    request.status = 'selected';
                }
                
                const seller = db.users.find(u => u.id === bid.sellerId);
                if (seller) {
                    seller.totalTransactions++;
                    seller.totalSales += bid.basePrice;
                }
                
                const buyer = db.users.find(u => u.id === request.buyerId);
                if (buyer) {
                    buyer.totalPurchase += bid.basePrice;
                }
                
                const totalPrice = bid.basePrice + (bid.basePrice * bid.vatPercentage / 100) + (bid.basePrice * bid.loadingPercentage / 100);
                
                const transaction = {
                    id: db.transactions.length + 1,
                    requestId: bid.requestId,
                    bidId: bid.id,
                    buyerId: currentUser.id,
                    sellerId: bid.sellerId,
                    amount: totalPrice,
                    status: 'completed',
                    createdAt: new Date().toISOString()
                };
                
                db.transactions.push(transaction);
                db.saveAll();
                
                alert('پیشنهاد با موفقیت پذیرفته شد!');
                closeModal('view-bids-modal');
                loadDashboard();
            }
        }

        function acceptShedBid(bidId) {
            const bid = db.shedBids.find(b => b.id === bidId);
            if (!bid) return;
            
            if (confirm('آیا از پذیرش این پیشنهاد اطمینان دارید؟')) {
                bid.status = 'accepted';
                
                const request = db.shedRequests.find(r => r.id === bid.requestId);
                if (request) {
                    request.status = 'selected';
                }
                
                const seller = db.users.find(u => u.id === bid.sellerId);
                if (seller) {
                    seller.totalTransactions++;
                    seller.totalSales += bid.totalPrice;
                }
                
                const buyer = db.users.find(u => u.id === request.buyerId);
                if (buyer) {
                    buyer.totalPurchase += bid.totalPrice;
                }
                
                const transaction = {
                    id: db.shedTransactions.length + 1,
                    requestId: bid.requestId,
                    bidId: bid.id,
                    buyerId: currentUser.id,
                    sellerId: bid.sellerId,
                    amount: bid.totalPrice,
                    status: 'completed',
                    createdAt: new Date().toISOString()
                };
                
                db.shedTransactions.push(transaction);
                db.saveAll();
                
                alert('پیشنهاد با موفقیت پذیرفته شد!');
                closeModal('view-shed-bids-modal');
                loadDashboard();
            }
        }

        function setRating(rating) {
            currentRating = rating;
            
            document.querySelectorAll('.rating-star').forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
            
            document.getElementById('rating-value').value = rating;
        }

        function submitRating() {
            const rating = currentRating;
            const comment = document.getElementById('rating-comment').value;
            const transactionId = document.getElementById('rating-transaction-id').value;
            
            if (rating === 0) {
                alert('لطفاً امتیاز دهید.');
                return;
            }
            
            const ratingObj = {
                id: db.ratings.length + 1,
                transactionId: parseInt(transactionId),
                userId: currentUser.id,
                rating,
                comment,
                createdAt: new Date().toISOString()
            };
            
            db.ratings.push(ratingObj);
            db.saveAll();
            
            alert('امتیاز شما ثبت شد. متشکریم!');
            closeModal('rating-modal');
        }

        // ==================== توابع سوله ====================
        function toggleDrawingUpload(show) {
            const section = document.getElementById('drawing-upload-section');
            if (show) {
                section.classList.remove('hidden');
            } else {
                section.classList.add('hidden');
            }
        }

        function toggleCraneDetails(show) {
            const section = document.getElementById('crane-details-section');
            if (show) {
                section.classList.remove('hidden');
            } else {
                section.classList.add('hidden');
            }
        }

        function toggleOtherPaintType() {
            const paintType = document.getElementById('paint-type').value;
            const otherPaintType = document.getElementById('other-paint-type');
            
            if (paintType === 'other') {
                otherPaintType.classList.remove('hidden');
                otherPaintType.required = true;
            } else {
                otherPaintType.classList.add('hidden');
                otherPaintType.required = false;
                otherPaintType.value = '';
            }
        }

        // ==================== مدیریت فرم سوله نو ====================
        document.getElementById('new-shed-form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('لطفاً ابتدا وارد حساب کاربری خود شوید.');
                showPage('login');
                return;
            }
            
            // جمع‌آوری داده‌های فرم
            const shedData = {
                id: db.shedRequests.length + 1,
                type: 'new',
                dimensions: {
                    length: parseFloat(document.getElementById('shed-length').value),
                    width: parseFloat(document.getElementById('shed-width').value),
                    height: parseFloat(document.getElementById('shed-height').value)
                },
                hasDrawing: document.querySelector('input[name="has-drawing"]:checked').value === 'yes',
                usage: document.getElementById('shed-usage').value,
                location: document.getElementById('shed-location').value,
                needsCrane: document.querySelector('input[name="needs-crane"]:checked').value === 'yes',
                craneTonnage: document.getElementById('crane-tonnage')?.value || null,
                foundation: document.querySelector('input[name="foundation"]:checked').value,
                sandblast: document.querySelector('input[name="sandblast"]:checked').value,
                paintType: document.getElementById('paint-type').value,
                otherPaintType: document.getElementById('other-paint-type').value || '',
                paintThickness: document.getElementById('paint-thickness').value || 50,
                buyerResponsibilities: Array.from(document.querySelectorAll('input[name="responsibility"]:checked')).map(cb => cb.value),
                weight: document.getElementById('shed-weight').value || null,
                priceType: document.querySelector('input[name="price-type"]:checked').value,
                buyerId: currentUser.id,
                status: 'open',
                createdAt: new Date().toISOString()
            };
            
            // ذخیره در دیتابیس
            db.addShedRequest(shedData);
            
            // نمایش پیام موفقیت
            alert('درخواست سوله نو با موفقیت ثبت شد! فروشندگان سوله به زودی پیشنهادهای خود را ارسال خواهند کرد.');
            
            // بازگشت به صفحه سوله
            showPage('shed');
        });

        // ==================== بارگذاری سوله‌های دست دوم ====================
        function loadSecondhandSheds() {
            showPage('secondhand-shed');
            
            const shedListings = db.getShedListings();
            
            const container = document.getElementById('shed-listings');
            let html = '';
            
            if (shedListings.length === 0) {
                html = `
                    <div class="shed-listing-item">
                        <p style="text-align: center; color: #6b7280;">در حال حاضر آگهی سوله دست دومی موجود نیست.</p>
                    </div>
                `;
            } else {
                shedListings.forEach(shed => {
                    html += `
                        <div class="shed-listing-item">
                            <div class="shed-listing-header">
                                <div class="shed-listing-title">${shed.title}</div>
                                <div class="shed-listing-price">${shed.price}</div>
                            </div>
                            
                            <div class="shed-listing-details">
                                <div><strong>محل:</strong> ${shed.location}</div>
                                <div><strong>ابعاد:</strong> ${shed.dimensions}</div>
                                <div><strong>سن:</strong> ${shed.age}</div>
                                <div><strong>شرایط:</strong> ${shed.condition}</div>
                                <div><strong>فروشنده:</strong> ${shed.seller}</div>
                                <div><strong>تلفن:</strong> ${shed.phone}</div>
                            </div>
                            
                            <div style="color: #6b7280; margin: 1rem 0; line-height: 1.6;">
                                ${shed.description}
                            </div>
                            
                            <div class="shed-listing-features">
                                ${shed.features.map(feature => `<span class="shed-feature-tag">${feature}</span>`).join('')}
                            </div>
                            
                            <div style="display: flex; gap: 10px; margin-top: 1rem;">
                                <button class="btn btn-primary btn-sm" onclick="contactSeller('${shed.phone}', '${shed.seller}')">
                                    <i class="fas fa-phone"></i> تماس با فروشنده
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="showShedDetails(${shed.id})">
                                    <i class="fas fa-info-circle"></i> جزئیات بیشتر
                                </button>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML = html;
        }

        function contactSeller(phone, sellerName) {
            if (confirm(`آیا می‌خواهید با ${sellerName} تماس بگیرید؟\nشماره: ${phone}`)) {
                window.location.href = `tel:${phone}`;
            }
        }

        function showShedDetails(shedId) {
            const shed = db.shedListings.find(s => s.id === shedId);
            if (!shed) return;
            
            alert(`جزئیات کامل سوله:\n\nعنوان: ${shed.title}\nمحل: ${shed.location}\nابعاد: ${shed.dimensions}\nشرایط: ${shed.condition}\nقیمت: ${shed.price}\n\n${shed.description}`);
        }

        // ==================== تابع ورود به سیستم قالب بتن ====================
        function enterConcreteFormworkSystem() {
            if (currentUser) {
                if (currentUser.userType === 'buyer') {
                    showPage('dashboard');
                } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'formwork') {
                    showPage('seller-formwork-dashboard');
                } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'shed') {
                    showPage('seller-shed-dashboard');
                } else if (currentUser.isAdmin) {
                    showPage('admin');
                }
            } else {
                showPage('login');
            }
        }

        // ==================== توابع نمونه برای توابع تعریف نشده ====================
        function loadFormworkSellerTransactions() {
            const content = document.getElementById('seller-formwork-dashboard-content');
            const sellerTransactions = db.transactions.filter(t => t.sellerId === currentUser.id);
            
            if (sellerTransactions.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز تراکنشی ندارید.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            sellerTransactions.forEach(transaction => {
                const buyer = db.users.find(u => u.id === transaction.buyerId);
                const request = db.requests.find(r => r.id === transaction.requestId);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">${request ? request.title : 'تراکنش'}</div>
                            <span class="request-badge badge-success">تکمیل شده</span>
                        </div>
                        <div class="request-details">
                            <div><strong>خریدار:</strong> ${buyer ? buyer.contactPerson : 'ناشناس'}</div>
                            <div><strong>مبلغ:</strong> ${formatNumberFarsiDisplay(transaction.amount)} ریال</div>
                            <div><strong>تاریخ:</strong> ${formatDate(transaction.createdAt)}</div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        function loadShedSellerTransactions() {
            const content = document.getElementById('seller-shed-dashboard-content');
            const sellerTransactions = db.shedTransactions.filter(t => t.sellerId === currentUser.id);
            
            if (sellerTransactions.length === 0) {
                content.innerHTML = `
                    <div class="requests-list">
                        <div class="request-item">
                            <p style="text-align: center; color: #6b7280;">هنوز تراکنشی ندارید.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="requests-list">';
            
            sellerTransactions.forEach(transaction => {
                const buyer = db.users.find(u => u.id === transaction.buyerId);
                const request = db.shedRequests.find(r => r.id === transaction.requestId);
                
                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">سوله ${request ? `${request.dimensions.length}x${request.dimensions.width} متر` : 'تراکنش'}</div>
                            <span class="request-badge badge-success">تکمیل شده</span>
                        </div>
                        <div class="request-details">
                            <div><strong>خریدار:</strong> ${buyer ? buyer.contactPerson : 'ناشناس'}</div>
                            <div><strong>مبلغ:</strong> ${formatNumberFarsiDisplay(transaction.amount)} ریال</div>
                            <div><strong>تاریخ:</strong> ${formatDate(transaction.createdAt)}</div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('current_user');
            showPage('home');
            alert('با موفقیت از حساب خود خارج شدید.');
        }

        // ==================== مقداردهی اولیه ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('پلتفرم B2BSteel (قالب بتن + سوله) بارگذاری شد.');
            
            // رویدادهای فرم‌ها
            const passwordConfirmInput = document.getElementById('reg-password-confirm');
            if (passwordConfirmInput) {
                passwordConfirmInput.addEventListener('input', validatePassword);
            }
            
            // رویداد فرم سوله
            const newShedForm = document.getElementById('new-shed-form');
            if (newShedForm) {
                newShedForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    if (!currentUser) {
                        alert('لطفاً ابتدا وارد حساب کاربری خود شوید.');
                        showPage('login');
                        return;
                    }
                    
                    // جمع‌آوری داده‌های فرم
                    const shedData = {
                        id: db.shedRequests.length + 1,
                        type: 'new',
                        dimensions: {
                            length: parseFloat(document.getElementById('shed-length').value),
                            width: parseFloat(document.getElementById('shed-width').value),
                            height: parseFloat(document.getElementById('shed-height').value)
                        },
                        hasDrawing: document.querySelector('input[name="has-drawing"]:checked').value === 'yes',
                        usage: document.getElementById('shed-usage').value,
                        location: document.getElementById('shed-location').value,
                        needsCrane: document.querySelector('input[name="needs-crane"]:checked').value === 'yes',
                        craneTonnage: document.getElementById('crane-tonnage')?.value || null,
                        foundation: document.querySelector('input[name="foundation"]:checked').value,
                        sandblast: document.querySelector('input[name="sandblast"]:checked').value,
                        paintType: document.getElementById('paint-type').value,
                        otherPaintType: document.getElementById('other-paint-type').value || '',
                        paintThickness: document.getElementById('paint-thickness').value || 50,
                        buyerResponsibilities: Array.from(document.querySelectorAll('input[name="responsibility"]:checked')).map(cb => cb.value),
                        weight: document.getElementById('shed-weight').value || null,
                        priceType: document.querySelector('input[name="price-type"]:checked').value,
                        buyerId: currentUser.id,
                        status: 'open',
                        createdAt: new Date().toISOString()
                    };
                    
                    // ذخیره در دیتابیس
                    db.addShedRequest(shedData);
                    
                    // نمایش پیام موفقیت
                    alert('درخواست سوله نو با موفقیت ثبت شد! فروشندگان سوله به زودی پیشنهادهای خود را ارسال خواهند کرد.');
                    
                    // بازگشت به صفحه سوله
                    showPage('shed');
                });
            }
            
            updateNavigation();
            
            if (currentUser) {
                if (currentUser.isAdmin) {
                    showPage('admin');
                } else if (currentUser.userType === 'buyer') {
                    showPage('dashboard');
                } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'formwork') {
                    showPage('seller-formwork-dashboard');
                } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'shed') {
                    showPage('seller-shed-dashboard');
                }
            } else {
                showPage('home');
            }
            
            loadCounters();
            initImageSlider();
            
            console.log('=== حساب‌های نمونه ===');
            console.log('خریدار: buyer@example.com / 123456');
            console.log('فروشنده قالب: seller-formwork@example.com / 123456');
            console.log('فروشنده سوله: seller-shed@example.com / 123456');
            console.log('ادمین: admin@example.com / admin123');
            console.log('===================');
        });
    </script>
</body>
</html>

